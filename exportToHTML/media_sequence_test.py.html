<html>
<head>
<title>media_sequence_test.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #a5c261;}
.s5 { color: #6897bb;}
.s6 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
media_sequence_test.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Copyright 2019 The MediaPipe Authors. 
 
Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); 
you may not use this file except in compliance with the License. 
You may obtain a copy of the License at 
 
     http://www.apache.org/licenses/LICENSE-2.0 
 
Unless required by applicable law or agreed to in writing, software 
distributed under the License is distributed on an &quot;AS IS&quot; BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
See the License for the specific language governing permissions and 
limitations under the License. 
 
Tests for media_sequence.py. 
&quot;&quot;&quot;</span>

<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">absolute_import</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">division</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">print_function</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">tensorflow.compat.v1 </span><span class="s2">as </span><span class="s1">tf</span>
<span class="s2">from </span><span class="s1">mediapipe.util.sequence </span><span class="s2">import </span><span class="s1">media_sequence </span><span class="s2">as </span><span class="s1">ms</span>


<span class="s2">class </span><span class="s1">MediaSequenceTest(tf.test.TestCase):</span>

  <span class="s2">def </span><span class="s1">test_expected_functions_are_defined(self):</span>
    <span class="s3"># The code from media_sequence_util is already tested, but this test ensures</span>
    <span class="s3"># that we actually generate the expected methods. We only test one per</span>
    <span class="s3"># feature and the only test is to not crash with undefined attributes. By</span>
    <span class="s3"># passing in a value, we also ensure that the types are correct because the</span>
    <span class="s3"># underlying code crashes with a type mismatch.</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s3"># context</span>
    <span class="s1">ms.set_example_id(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_example_dataset_name(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_example_dataset_flag_string([</span><span class="s4">b&quot;overal&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_media_id(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_alternative_media_id(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_encoded_media_bytes(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_encoded_media_start_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_data_path(</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_start_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_end_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_label_string((</span><span class="s4">b&quot;string&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_label_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_clip_label_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_start_timestamp((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_start_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_end_timestamp((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_end_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_label_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_label_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_segment_label_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_format(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_channels(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_colorspace(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_height(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_width(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_frame_rate(</span><span class="s5">0.47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_image_data_path(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_format(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_channels(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_colorspace(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_height(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_width(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_forward_flow_frame_rate(</span><span class="s5">0.47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_class_segmentation_format(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_class_segmentation_height(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_class_segmentation_width(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_class_segmentation_class_label_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_class_segmentation_class_label_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_instance_segmentation_format(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_instance_segmentation_height(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_instance_segmentation_width(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_instance_segmentation_object_class_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_bbox_parts((</span><span class="s4">b&quot;HEAD&quot;</span><span class="s2">, </span><span class="s4">b&quot;TOE&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_context_feature_floats((</span><span class="s5">47.</span><span class="s2">, </span><span class="s5">35.</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_context_feature_bytes((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_context_feature_ints((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">35</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s3"># feature lists</span>
    <span class="s1">ms.add_image_encoded(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_image_multi_encoded([</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_image_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_forward_flow_encoded(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_forward_flow_multi_encoded([</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_forward_flow_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_ymin((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_xmin((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_ymax((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_xmax((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_point_x((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_point_y((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_3d_point_x((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_3d_point_y((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_3d_point_z((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_ymin((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_xmin((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_ymax((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_xmax((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_num_regions(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_is_annotated(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_is_generated((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_is_occluded((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_label_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_label_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_label_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_class_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_class_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_class_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_track_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_track_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_track_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_class_index((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_class_string((</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;strings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_class_segmentation_encoded(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_class_segmentation_multi_encoded([</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_instance_segmentation_encoded(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_instance_segmentation_multi_encoded([</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s4">b&quot;test&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_class_segmentation_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_bbox_embedding_dimensions_per_region((</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_bbox_embedding_format(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_embedding_floats((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_embedding_encoded((</span><span class="s4">b&quot;text&quot;</span><span class="s2">, </span><span class="s4">b&quot;stings&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_embedding_confidence((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_text_language(</span><span class="s4">b&quot;test&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.set_text_context_content(</span><span class="s4">b&quot;text&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_content(</span><span class="s4">b&quot;one&quot;</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_timestamp(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_confidence(</span><span class="s5">0.47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_duration(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_token_id(</span><span class="s5">47</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_text_embedding((</span><span class="s5">0.47</span><span class="s2">, </span><span class="s5">0.49</span><span class="s1">)</span><span class="s2">, </span><span class="s1">example)</span>

  <span class="s2">def </span><span class="s1">test_bbox_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">boxes = np.array([[</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s2">, </span><span class="s5">0.4</span><span class="s1">]</span><span class="s2">,</span>
                      <span class="s1">[</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">0.6</span><span class="s2">, </span><span class="s5">0.7</span><span class="s2">, </span><span class="s5">0.8</span><span class="s1">]])</span>
    <span class="s1">empty_boxes = np.array([])</span>
    <span class="s1">ms.add_bbox(boxes</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox(empty_boxes</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_bbox_size(example))</span>
    <span class="s1">self.assertAllClose(boxes</span><span class="s2">, </span><span class="s1">ms.get_bbox_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example))</span>
    <span class="s1">self.assertTrue(ms.has_bbox(example))</span>
    <span class="s1">ms.clear_bbox(example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_bbox_size(example))</span>

  <span class="s2">def </span><span class="s1">test_point_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">points = np.array([[</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s1">]</span><span class="s2">,</span>
                       <span class="s1">[</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">0.6</span><span class="s1">]])</span>
    <span class="s1">ms.add_bbox_point(points</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_point(points</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_size(example))</span>
    <span class="s1">self.assertAllClose(points</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example))</span>
    <span class="s1">self.assertTrue(ms.has_bbox_point(example))</span>
    <span class="s1">ms.clear_bbox_point(example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_size(example))</span>

  <span class="s2">def </span><span class="s1">test_prefixed_point_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">points = np.array([[</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s1">]</span><span class="s2">,</span>
                       <span class="s1">[</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">0.6</span><span class="s1">]])</span>
    <span class="s1">ms.add_bbox_point(points</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">)</span>
    <span class="s1">ms.add_bbox_point(points</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_size(example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertAllClose(points</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_bbox_point(example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_bbox_point(example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_bbox_point_size(example</span><span class="s2">, </span><span class="s6">&quot;test&quot;</span><span class="s1">))</span>

  <span class="s2">def </span><span class="s1">test_3d_point_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">points = np.array([[</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s1">]</span><span class="s2">,</span>
                       <span class="s1">[</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">0.6</span><span class="s2">, </span><span class="s5">0.7</span><span class="s1">]])</span>
    <span class="s1">ms.add_bbox_3d_point(points</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_bbox_3d_point(points</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_bbox_3d_point_size(example))</span>
    <span class="s1">self.assertAllClose(points</span><span class="s2">, </span><span class="s1">ms.get_bbox_3d_point_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example))</span>
    <span class="s1">self.assertTrue(ms.has_bbox_3d_point(example))</span>
    <span class="s1">ms.clear_bbox_3d_point(example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_bbox_3d_point_size(example))</span>

  <span class="s2">def </span><span class="s1">test_predicted_bbox_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">boxes = np.array([[</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s2">, </span><span class="s5">0.4</span><span class="s1">]</span><span class="s2">,</span>
                      <span class="s1">[</span><span class="s5">0.5</span><span class="s2">, </span><span class="s5">0.6</span><span class="s2">, </span><span class="s5">0.7</span><span class="s2">, </span><span class="s5">0.8</span><span class="s1">]])</span>
    <span class="s1">ms.add_predicted_bbox(boxes</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">ms.add_predicted_bbox(boxes</span><span class="s2">, </span><span class="s1">example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_predicted_bbox_size(example))</span>
    <span class="s1">self.assertAllClose(boxes</span><span class="s2">, </span><span class="s1">ms.get_predicted_bbox_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example))</span>
    <span class="s1">self.assertTrue(ms.has_predicted_bbox(example))</span>
    <span class="s1">ms.clear_predicted_bbox(example)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_predicted_bbox_size(example))</span>

  <span class="s2">def </span><span class="s1">test_float_list_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">values_1 = [</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s1">]</span>
    <span class="s1">values_2 = [</span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s2">, </span><span class="s5">0.4</span><span class="s1">]</span>
    <span class="s1">ms.add_feature_floats(values_1</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">ms.add_feature_floats(values_1</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">ms.add_feature_floats(values_2</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_size(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertEqual(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertAllClose(values_1</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertAllClose(values_2</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_size(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertFalse(ms.has_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertEqual(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_feature_floats_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertFalse(ms.has_feature_floats(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>

  <span class="s2">def </span><span class="s1">test_feature_timestamp_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">values_1 = </span><span class="s5">47</span>
    <span class="s1">values_2 = </span><span class="s5">49</span>
    <span class="s1">ms.add_feature_timestamp(values_1</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">ms.add_feature_timestamp(values_1</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">ms.add_feature_timestamp(values_2</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">ms.get_feature_timestamp_size(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertEqual(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ms.get_feature_timestamp_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertAllClose(values_1</span><span class="s2">,</span>
                        <span class="s1">ms.get_feature_timestamp_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertAllClose(values_2</span><span class="s2">,</span>
                        <span class="s1">ms.get_feature_timestamp_at(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_feature_timestamp_size(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertFalse(ms.has_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertEqual(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ms.get_feature_timestamp_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertEqual(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">ms.get_feature_timestamp_size(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertFalse(ms.has_feature_timestamp(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>

  <span class="s2">def </span><span class="s1">test_feature_dimensions_round_trip(self):</span>
    <span class="s1">example = tf.train.SequenceExample()</span>
    <span class="s1">ms.set_feature_dimensions([</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">ms.set_feature_dimensions([</span><span class="s5">49</span><span class="s2">, </span><span class="s5">50</span><span class="s1">]</span><span class="s2">, </span><span class="s1">example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertSequenceEqual([</span><span class="s5">47</span><span class="s2">, </span><span class="s5">49</span><span class="s1">]</span><span class="s2">,</span>
                             <span class="s1">ms.get_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertSequenceEqual([</span><span class="s5">49</span><span class="s2">, </span><span class="s5">50</span><span class="s1">]</span><span class="s2">,</span>
                             <span class="s1">ms.get_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertFalse(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertTrue(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>
    <span class="s1">ms.clear_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">)</span>
    <span class="s1">self.assertFalse(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;1&quot;</span><span class="s1">))</span>
    <span class="s1">self.assertFalse(ms.has_feature_dimensions(example</span><span class="s2">, </span><span class="s6">&quot;2&quot;</span><span class="s1">))</span>


<span class="s2">if </span><span class="s1">__name__ == </span><span class="s6">&quot;__main__&quot;</span><span class="s1">:</span>
  <span class="s1">tf.test.main()</span>
</pre>
</body>
</html>