<html>
<head>
<title>media_sequence_util.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
media_sequence_util.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Copyright 2019 The MediaPipe Authors. 
 
Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); 
you may not use this file except in compliance with the License. 
You may obtain a copy of the License at 
 
     http://www.apache.org/licenses/LICENSE-2.0 
 
Unless required by applicable law or agreed to in writing, software 
distributed under the License is distributed on an &quot;AS IS&quot; BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
See the License for the specific language governing permissions and 
limitations under the License. 
 
Utilities for creating MediaSequence functions. 
 
A set of lightweight functions to simplify access to tensorflow SequenceExample 
features and functions to create getters and setters for common types. 
&quot;&quot;&quot;</span>

<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">absolute_import</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">division</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">print_function</span>

<span class="s2">import </span><span class="s1">types</span>
<span class="s2">import </span><span class="s1">tensorflow.compat.v1 </span><span class="s2">as </span><span class="s1">tf</span>


<span class="s2">def </span><span class="s1">function_with_default(f</span><span class="s2">, </span><span class="s1">default):</span>
  <span class="s0">&quot;&quot;&quot;Creates a new function with a default last parameter.&quot;&quot;&quot;</span>
  <span class="s2">return </span><span class="s1">types.FunctionType(f.__code__</span><span class="s2">, </span><span class="s1">f.__globals__</span><span class="s2">, </span><span class="s1">f.__name__</span><span class="s2">,</span>
                            <span class="s1">(default</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">f.__closure__)</span>


<span class="s2">def </span><span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Adds functions to another module. 
 
  Args: 
    function_dict: a list of names and function references. The functions will 
      be accessible in the new module by the name. 
    module_dict: The results of globals() for the current module or 
      a_module.__dict__() call. Adding values to these dicts makes the functions 
      accessible from the module. If not specified, globals() is used. 
  &quot;&quot;&quot;</span>
  <span class="s2">if </span><span class="s1">module_dict </span><span class="s2">is None</span><span class="s1">:</span>
    <span class="s1">module_dict = globals()</span>
  <span class="s2">for </span><span class="s1">name </span><span class="s2">in </span><span class="s1">function_dict:</span>
    <span class="s1">module_dict[name] = function_dict[name]</span>


<span class="s2">def </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key):</span>
  <span class="s2">if </span><span class="s1">prefix:</span>
    <span class="s2">return </span><span class="s3">&quot;/&quot;</span><span class="s1">.join((prefix</span><span class="s2">, </span><span class="s1">key))</span>
  <span class="s2">else</span><span class="s1">:</span>
    <span class="s2">return </span><span class="s1">key</span>


<span class="s2">def </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key) </span><span class="s2">in </span><span class="s1">sequence.context.feature</span>


<span class="s2">def </span><span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">del </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)]</span>


<span class="s2">def </span><span class="s1">set_context_float(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].float_list.value[:] = (</span>
      <span class="s1">value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">get_context_float(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].float_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">set_context_bytes(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].bytes_list.value[:] = (value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">get_context_bytes(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].bytes_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">set_context_int(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].int64_list.value[:] = (value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">get_context_int(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].int64_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">set_context_float_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].float_list.value[:] = value</span>


<span class="s2">def </span><span class="s1">get_context_float_list(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].float_list.value</span>


<span class="s2">def </span><span class="s1">set_context_bytes_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].bytes_list.value[:] = value</span>


<span class="s2">def </span><span class="s1">get_context_bytes_list(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].bytes_list.value</span>


<span class="s2">def </span><span class="s1">set_context_int_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.context.feature[merge_prefix(</span>
      <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].int64_list.value[:] = value</span>


<span class="s2">def </span><span class="s1">get_context_int_list(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.context.feature[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].int64_list.value</span>


<span class="s2">def </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key) </span><span class="s2">in </span><span class="s1">sequence.feature_lists.feature_list</span>


<span class="s2">def </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">if </span><span class="s1">has_feature_list(merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span><span class="s2">, </span><span class="s1">sequence):</span>
    <span class="s2">return </span><span class="s1">len(sequence.feature_lists.feature_list[merge_prefix(</span>
        <span class="s1">prefix</span><span class="s2">, </span><span class="s1">key)].feature)</span>
  <span class="s2">else</span><span class="s1">:</span>
    <span class="s2">return </span><span class="s4">0</span>


<span class="s2">def </span><span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">del </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)]</span>


<span class="s2">def </span><span class="s1">get_float_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].float_list.value</span>


<span class="s2">def </span><span class="s1">get_int_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].int64_list.value</span>


<span class="s2">def </span><span class="s1">get_bytes_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].bytes_list.value</span>


<span class="s2">def </span><span class="s1">add_float_list(key</span><span class="s2">, </span><span class="s1">values</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).float_list.value[:] = values</span>


<span class="s2">def </span><span class="s1">add_bytes_list(key</span><span class="s2">, </span><span class="s1">values</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).bytes_list.value[:] = values</span>


<span class="s2">def </span><span class="s1">add_int_list(key</span><span class="s2">, </span><span class="s1">values</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).int64_list.value[:] = values</span>


<span class="s2">def </span><span class="s1">get_float_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].float_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">get_int_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].int64_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">get_bytes_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s2">return </span><span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature[</span>
      <span class="s1">index].bytes_list.value[</span><span class="s4">0</span><span class="s1">]</span>


<span class="s2">def </span><span class="s1">add_float(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).float_list.value[:] = (value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">add_bytes(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).bytes_list.value[:] = (value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">add_int(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
  <span class="s1">sequence.feature_lists.feature_list[merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)].feature.add(</span>
  <span class="s1">).int64_list.value[:] = (value</span><span class="s2">,</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">create_bytes_list_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of bytes features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_clip_label_string([&quot;dog&quot;, &quot;cat&quot;], example) 
    if has_clip_label_string(example): 
      clip_label_string = get_clip_label_string(example) 
      clear_clip_label_string(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_bytes_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_bytes_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.string)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_float_list_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of floats features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_segment_label_confidence([0.47, 0.49], example) 
    if has_segment_label_confidence(example): 
      confidences = get_segment_label_confidence(example) 
      clear_segment_label_confidence(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_float_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_float_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.float32)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_int_list_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of int64 features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_clip_label_index([0, 1, 2, 3], example) 
    if has_clip_label_index(example): 
      clip_label_index = get_clip_label_index(example) 
      clear_clip_label_index 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_int_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_int_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.int64)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_bytes_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for single bytes features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_data_path(&quot;path_to_a_file&quot;, example) 
    if has_data_path(example): 
      path = get_data_path(example) 
      clear_data_path(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_bytes(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_bytes(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenFeature(()</span><span class="s2">, </span><span class="s1">tf.string)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_float_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for single float features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_image_frame_rate(0.47, example) 
    if has_image_frame_rate(example): 
      image_frame_rate = get_image_frame_rate(example) 
      clear_image_frame_rate(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_float(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_float(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenFeature(()</span><span class="s2">, </span><span class="s1">tf.float32)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_int_context_feature(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for single int64 features. 
 
  The provided functions are has_${NAME}, get_${NAME}, set_${NAME} and 
  clear_${NAME}. 
 
  Example: 
    example = tensorflow.train.SequenceExample() 
    set_clip_frames(47, example) 
    if has_clip_frames(example): 
      clip_frames = get_clip_frames(example) 
      clear_clip_frames(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_context_int(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_context(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_set(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">set_context_int(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenFeature(()</span><span class="s2">, </span><span class="s1">tf.int64)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name: _get</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;set_&quot; </span><span class="s1">+ name: _set</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_bytes_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for bytes feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_image_encoded(1000000, example) 
  add_image_encoded(2000000, example) 
  if has_image_encoded: 
    for i in range(get_image_encoded_size(example): 
      image_encoded = get_image_encoded_at(i, example) 
    clear_image_encoded(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_bytes_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_bytes(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenSequenceFeature(()</span><span class="s2">, </span><span class="s1">tf.string)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_float_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for float feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_confidence(0.47, example) 
  add_confidence(0.49, example) 
  if has_confidence: 
    for i in range(get_confidence_size(example): 
      confidence = get_confidence_at(i, example) 
    clear_confidence(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_float_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_float(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenSequenceFeature(()</span><span class="s2">, </span><span class="s1">tf.float32)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_int_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for bytes feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_image_timestamp(1000000, example) 
  add_image_timestamp(2000000, example) 
  if has_image_timestamp: 
    for i in range(get_image_timestamp_size(example): 
      timestamp = get_image_timestamp_at(i, example) 
    clear_image_timestamp(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_int_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_int(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.FixedLenSequenceFeature(()</span><span class="s2">, </span><span class="s1">tf.int64)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_bytes_list_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of bytes feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_bbox_label_string([&quot;dog&quot;, &quot;cat&quot;], example) 
  add_bbox_label_string([&quot;cat&quot;, &quot;dog&quot;], example) 
  if has_bbox_label_string: 
    for i in range(get_bbox_label_string_size(example): 
      timestamp = get_bbox_label_string_at(i, example) 
    clear_bbox_label_string(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_bytes_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_bytes_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.string)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_float_list_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of float feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_bbox_ymin([0.47, 0.49], example) 
  add_bbox_ymin([0.49, 0.47], example) 
  if has_bbox_ymin: 
    for i in range(get_bbox_ymin_size(example): 
      bbox_ymin = get_bbox_ymin_at(i, example) 
    clear_bbox_ymin(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_float_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_float_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.float32)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>


<span class="s2">def </span><span class="s1">create_int_list_feature_list(name</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">module_dict=</span><span class="s2">None</span><span class="s1">):</span>
  <span class="s0">&quot;&quot;&quot;Creates accessor functions for list of int64 feature lists. 
 
  The provided functions are has_${NAME}, get_${NAME}_size, get_${NAME}_at, 
  clear_${NAME}, and add_${NAME}. 
 
  example = tensorflow.train.SequenceExample() 
  add_bbox_label_index([47, 49], example) 
  add_bbox_label_index([49, 47], example) 
  if has_bbox_label_index: 
    for i in range(get_bbox_label_index_size(example): 
      bbox_label_index = get_bbox_label_index_at(i, example) 
    clear_bbox_label_index(example) 
 
  Args: 
    name: the name of the feature to use in function names. 
    key: the key for this feature in the SequenceExample. 
    prefix: a prefix to append to the key in the SequenceExample 
    module_dict: adds the functions to the corresponding module dict. 
  &quot;&quot;&quot;</span>
  <span class="s2">def </span><span class="s1">_has(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">has_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_feature_list_size(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">get_int_list_at(key</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_clear(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">clear_feature_list(key</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_add(value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix):</span>
    <span class="s1">add_int_list(key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>

  <span class="s2">def </span><span class="s1">_get_key(prefix=prefix):</span>
    <span class="s2">return </span><span class="s1">merge_prefix(prefix</span><span class="s2">, </span><span class="s1">key)</span>

  <span class="s2">def </span><span class="s1">_get_default_parser():</span>
    <span class="s2">return </span><span class="s1">tf.io.VarLenFeature(tf.int64)</span>

  <span class="s1">function_dict = {</span>
      <span class="s3">&quot;has_&quot; </span><span class="s1">+ name: _has</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_size&quot;</span><span class="s1">: _get_size</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_at&quot;</span><span class="s1">: _get_at</span><span class="s2">,</span>
      <span class="s3">&quot;clear_&quot; </span><span class="s1">+ name: _clear</span><span class="s2">,</span>
      <span class="s3">&quot;add_&quot; </span><span class="s1">+ name: _add</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_key&quot;</span><span class="s1">: _get_key</span><span class="s2">,</span>
      <span class="s3">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s3">&quot;_default_parser&quot;</span><span class="s1">: _get_default_parser</span><span class="s2">,</span>
  <span class="s1">}</span>
  <span class="s1">add_functions_to_module(function_dict</span><span class="s2">, </span><span class="s1">module_dict)</span>
</pre>
</body>
</html>