<html>
<head>
<title>test_polar.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_polar.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">assert_allclose</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">matplotlib </span><span class="s0">as </span><span class="s1">mpl</span>
<span class="s0">from </span><span class="s1">matplotlib </span><span class="s0">import </span><span class="s1">pyplot </span><span class="s0">as </span><span class="s1">plt</span>
<span class="s0">from </span><span class="s1">matplotlib.testing.decorators </span><span class="s0">import </span><span class="s1">image_comparison</span><span class="s0">, </span><span class="s1">check_figures_equal</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_axes'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s0">, </span><span class="s1">tol=</span><span class="s3">0.012</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_annotations():</span>
    <span class="s4"># You can specify the xypoint and the xytext in different positions and</span>
    <span class="s4"># coordinate systems, and optionally turn on a connecting line and mark the</span>
    <span class="s4"># point with a marker.  Annotations work on polar axes too.  In the example</span>
    <span class="s4"># below, the xy point is in native coordinates (xycoords defaults to</span>
    <span class="s4"># 'data').  For a polar axes, this is in (theta, radius) space.  The text</span>
    <span class="s4"># in this example is placed in the fractional figure coordinate system.</span>
    <span class="s4"># Text keyword args like horizontal and vertical alignment are respected.</span>

    <span class="s4"># Setup some data</span>
    <span class="s1">r = np.arange(</span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.001</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2.0 </span><span class="s1">* </span><span class="s3">2.0 </span><span class="s1">* np.pi * r</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_subplot(polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">line</span><span class="s0">, </span><span class="s1">= ax.plot(theta</span><span class="s0">, </span><span class="s1">r</span><span class="s0">, </span><span class="s1">color=</span><span class="s2">'#ee8d18'</span><span class="s0">, </span><span class="s1">lw=</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">line</span><span class="s0">, </span><span class="s1">= ax.plot((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">color=</span><span class="s2">&quot;#0000ff&quot;</span><span class="s0">, </span><span class="s1">lw=</span><span class="s3">1</span><span class="s1">)</span>

    <span class="s1">ind = </span><span class="s3">800</span>
    <span class="s1">thisr</span><span class="s0">, </span><span class="s1">thistheta = r[ind]</span><span class="s0">, </span><span class="s1">theta[ind]</span>
    <span class="s1">ax.plot([thistheta]</span><span class="s0">, </span><span class="s1">[thisr]</span><span class="s0">, </span><span class="s2">'o'</span><span class="s1">)</span>
    <span class="s1">ax.annotate(</span><span class="s2">'a polar annotation'</span><span class="s0">,</span>
                <span class="s1">xy=(thistheta</span><span class="s0">, </span><span class="s1">thisr)</span><span class="s0">,  </span><span class="s4"># theta, radius</span>
                <span class="s1">xytext=(</span><span class="s3">0.05</span><span class="s0">, </span><span class="s3">0.05</span><span class="s1">)</span><span class="s0">,    </span><span class="s4"># fraction, fraction</span>
                <span class="s1">textcoords=</span><span class="s2">'figure fraction'</span><span class="s0">,</span>
                <span class="s1">arrowprops=dict(facecolor=</span><span class="s2">'black'</span><span class="s0">, </span><span class="s1">shrink=</span><span class="s3">0.05</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">horizontalalignment=</span><span class="s2">'left'</span><span class="s0">,</span>
                <span class="s1">verticalalignment=</span><span class="s2">'baseline'</span><span class="s0">,</span>
                <span class="s1">)</span>

    <span class="s1">ax.tick_params(axis=</span><span class="s2">'x'</span><span class="s0">, </span><span class="s1">tick1On=</span><span class="s0">True, </span><span class="s1">tick2On=</span><span class="s0">True, </span><span class="s1">direction=</span><span class="s2">'out'</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_coords'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s0">, </span><span class="s1">remove_text=</span><span class="s0">True,</span>
                  <span class="s1">tol=</span><span class="s3">0.012</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_coord_annotations():</span>
    <span class="s4"># You can also use polar notation on a cartesian axes.  Here the native</span>
    <span class="s4"># coordinate system ('data') is cartesian, so you need to specify the</span>
    <span class="s4"># xycoords and textcoords as 'polar' if you want to use (theta, radius).</span>
    <span class="s1">el = mpl.patches.Ellipse((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s1">facecolor=</span><span class="s2">'r'</span><span class="s0">, </span><span class="s1">alpha=</span><span class="s3">0.5</span><span class="s1">)</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_subplot(aspect=</span><span class="s2">'equal'</span><span class="s1">)</span>

    <span class="s1">ax.add_artist(el)</span>
    <span class="s1">el.set_clip_box(ax.bbox)</span>

    <span class="s1">ax.annotate(</span><span class="s2">'the top'</span><span class="s0">,</span>
                <span class="s1">xy=(np.pi/</span><span class="s3">2.</span><span class="s0">, </span><span class="s3">10.</span><span class="s1">)</span><span class="s0">,      </span><span class="s4"># theta, radius</span>
                <span class="s1">xytext=(np.pi/</span><span class="s3">3</span><span class="s0">, </span><span class="s3">20.</span><span class="s1">)</span><span class="s0">,   </span><span class="s4"># theta, radius</span>
                <span class="s1">xycoords=</span><span class="s2">'polar'</span><span class="s0">,</span>
                <span class="s1">textcoords=</span><span class="s2">'polar'</span><span class="s0">,</span>
                <span class="s1">arrowprops=dict(facecolor=</span><span class="s2">'black'</span><span class="s0">, </span><span class="s1">shrink=</span><span class="s3">0.05</span><span class="s1">)</span><span class="s0">,</span>
                <span class="s1">horizontalalignment=</span><span class="s2">'left'</span><span class="s0">,</span>
                <span class="s1">verticalalignment=</span><span class="s2">'baseline'</span><span class="s0">,</span>
                <span class="s1">clip_on=</span><span class="s0">True,  </span><span class="s4"># clip to the axes bounding box</span>
                <span class="s1">)</span>

    <span class="s1">ax.set_xlim(-</span><span class="s3">20</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
    <span class="s1">ax.set_ylim(-</span><span class="s3">20</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_alignment.png'</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_polar_alignment():</span>
    <span class="s4"># Test changing the vertical/horizontal alignment of a polar graph.</span>
    <span class="s1">angles = np.arange(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">360</span><span class="s0">, </span><span class="s3">90</span><span class="s1">)</span>
    <span class="s1">grid_values = [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.6</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">rect = [</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span>

    <span class="s1">horizontal = fig.add_axes(rect</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True, </span><span class="s1">label=</span><span class="s2">'horizontal'</span><span class="s1">)</span>
    <span class="s1">horizontal.set_thetagrids(angles)</span>

    <span class="s1">vertical = fig.add_axes(rect</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True, </span><span class="s1">label=</span><span class="s2">'vertical'</span><span class="s1">)</span>
    <span class="s1">vertical.patch.set_visible(</span><span class="s0">False</span><span class="s1">)</span>

    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">2</span><span class="s1">):</span>
        <span class="s1">fig.axes[i].set_rgrids(</span>
            <span class="s1">grid_values</span><span class="s0">, </span><span class="s1">angle=angles[i]</span><span class="s0">,</span>
            <span class="s1">horizontalalignment=</span><span class="s2">'left'</span><span class="s0">, </span><span class="s1">verticalalignment=</span><span class="s2">'top'</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_polar_twice():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">plt.polar([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">.2</span><span class="s1">])</span>
    <span class="s1">plt.polar([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.3</span><span class="s0">, </span><span class="s3">.4</span><span class="s1">])</span>
    <span class="s0">assert </span><span class="s1">len(fig.axes) == </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'More than one polar axes created.'</span>


<span class="s1">@check_figures_equal()</span>
<span class="s0">def </span><span class="s1">test_polar_wrap(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s1">ax = fig_test.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax.plot(np.deg2rad([</span><span class="s3">179</span><span class="s0">, </span><span class="s1">-</span><span class="s3">179</span><span class="s1">])</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s1">ax.plot(np.deg2rad([</span><span class="s3">2</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">])</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s1">ax = fig_ref.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax.plot(np.deg2rad([</span><span class="s3">179</span><span class="s0">, </span><span class="s3">181</span><span class="s1">])</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
    <span class="s1">ax.plot(np.deg2rad([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">358</span><span class="s1">])</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>


<span class="s1">@check_figures_equal()</span>
<span class="s0">def </span><span class="s1">test_polar_units_1(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s0">import </span><span class="s1">matplotlib.testing.jpl_units </span><span class="s0">as </span><span class="s1">units</span>
    <span class="s1">units.register()</span>
    <span class="s1">xs = [</span><span class="s3">30.0</span><span class="s0">, </span><span class="s3">45.0</span><span class="s0">, </span><span class="s3">60.0</span><span class="s0">, </span><span class="s3">90.0</span><span class="s1">]</span>
    <span class="s1">ys = [</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">4.0</span><span class="s1">]</span>

    <span class="s1">plt.figure(fig_test.number)</span>
    <span class="s1">plt.polar([x * units.deg </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">xs]</span><span class="s0">, </span><span class="s1">ys)</span>

    <span class="s1">ax = fig_ref.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax.plot(np.deg2rad(xs)</span><span class="s0">, </span><span class="s1">ys)</span>
    <span class="s1">ax.set(xlabel=</span><span class="s2">&quot;deg&quot;</span><span class="s1">)</span>


<span class="s1">@check_figures_equal()</span>
<span class="s0">def </span><span class="s1">test_polar_units_2(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s0">import </span><span class="s1">matplotlib.testing.jpl_units </span><span class="s0">as </span><span class="s1">units</span>
    <span class="s1">units.register()</span>
    <span class="s1">xs = [</span><span class="s3">30.0</span><span class="s0">, </span><span class="s3">45.0</span><span class="s0">, </span><span class="s3">60.0</span><span class="s0">, </span><span class="s3">90.0</span><span class="s1">]</span>
    <span class="s1">xs_deg = [x * units.deg </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">xs]</span>
    <span class="s1">ys = [</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">4.0</span><span class="s1">]</span>
    <span class="s1">ys_km = [y * units.km </span><span class="s0">for </span><span class="s1">y </span><span class="s0">in </span><span class="s1">ys]</span>

    <span class="s1">plt.figure(fig_test.number)</span>
    <span class="s4"># test {theta,r}units.</span>
    <span class="s1">plt.polar(xs_deg</span><span class="s0">, </span><span class="s1">ys_km</span><span class="s0">, </span><span class="s1">thetaunits=</span><span class="s2">&quot;rad&quot;</span><span class="s0">, </span><span class="s1">runits=</span><span class="s2">&quot;km&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">isinstance(plt.gca().xaxis.get_major_formatter()</span><span class="s0">,</span>
                      <span class="s1">units.UnitDblFormatter)</span>

    <span class="s1">ax = fig_ref.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax.plot(np.deg2rad(xs)</span><span class="s0">, </span><span class="s1">ys)</span>
    <span class="s1">ax.xaxis.set_major_formatter(mpl.ticker.FuncFormatter(</span><span class="s2">&quot;{:.12}&quot;</span><span class="s1">.format))</span>
    <span class="s1">ax.set(xlabel=</span><span class="s2">&quot;rad&quot;</span><span class="s0">, </span><span class="s1">ylabel=</span><span class="s2">&quot;km&quot;</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_rmin'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_rmin():</span>
    <span class="s1">r = np.arange(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2</span><span class="s1">*np.pi*r</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.plot(theta</span><span class="s0">, </span><span class="s1">r)</span>
    <span class="s1">ax.set_rmax(</span><span class="s3">2.0</span><span class="s1">)</span>
    <span class="s1">ax.set_rmin(</span><span class="s3">0.5</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_negative_rmin'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_negative_rmin():</span>
    <span class="s1">r = np.arange(-</span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2</span><span class="s1">*np.pi*r</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.plot(theta</span><span class="s0">, </span><span class="s1">r)</span>
    <span class="s1">ax.set_rmax(</span><span class="s3">0.0</span><span class="s1">)</span>
    <span class="s1">ax.set_rmin(-</span><span class="s3">3.0</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_rorigin'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_rorigin():</span>
    <span class="s1">r = np.arange(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2</span><span class="s1">*np.pi*r</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.plot(theta</span><span class="s0">, </span><span class="s1">r)</span>
    <span class="s1">ax.set_rmax(</span><span class="s3">2.0</span><span class="s1">)</span>
    <span class="s1">ax.set_rmin(</span><span class="s3">0.5</span><span class="s1">)</span>
    <span class="s1">ax.set_rorigin(</span><span class="s3">0.0</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_invertedylim.png'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_invertedylim():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.set_ylim(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_invertedylim_rorigin.png'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_invertedylim_rorigin():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.yaxis.set_inverted(</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s4"># Set the rlims to inverted (2, 0) without calling set_rlim, to check that</span>
    <span class="s4"># viewlims are correctly unstaled before draw()ing.</span>
    <span class="s1">ax.plot([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">c=</span><span class="s2">&quot;none&quot;</span><span class="s1">)</span>
    <span class="s1">ax.margins(</span><span class="s3">0</span><span class="s1">)</span>
    <span class="s1">ax.set_rorigin(</span><span class="s3">3</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_theta_position'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_theta_position():</span>
    <span class="s1">r = np.arange(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2</span><span class="s1">*np.pi*r</span>

    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_axes([</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">]</span><span class="s0">, </span><span class="s1">polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">ax.plot(theta</span><span class="s0">, </span><span class="s1">r)</span>
    <span class="s1">ax.set_theta_zero_location(</span><span class="s2">&quot;NW&quot;</span><span class="s0">, </span><span class="s3">30</span><span class="s1">)</span>
    <span class="s1">ax.set_theta_direction(</span><span class="s2">'clockwise'</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_rlabel_position'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_rlabel_position():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_subplot(projection=</span><span class="s2">'polar'</span><span class="s1">)</span>
    <span class="s1">ax.set_rlabel_position(</span><span class="s3">315</span><span class="s1">)</span>
    <span class="s1">ax.tick_params(rotation=</span><span class="s2">'auto'</span><span class="s1">)</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_theta_wedge'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_theta_limits():</span>
    <span class="s1">r = np.arange(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">)</span>
    <span class="s1">theta = </span><span class="s3">2</span><span class="s1">*np.pi*r</span>

    <span class="s1">theta_mins = np.arange(</span><span class="s3">15.0</span><span class="s0">, </span><span class="s3">361.0</span><span class="s0">, </span><span class="s3">90.0</span><span class="s1">)</span>
    <span class="s1">theta_maxs = np.arange(</span><span class="s3">50.0</span><span class="s0">, </span><span class="s3">361.0</span><span class="s0">, </span><span class="s3">90.0</span><span class="s1">)</span>
    <span class="s1">DIRECTIONS = (</span><span class="s2">'out'</span><span class="s0">, </span><span class="s2">'in'</span><span class="s0">, </span><span class="s2">'inout'</span><span class="s1">)</span>

    <span class="s1">fig</span><span class="s0">, </span><span class="s1">axs = plt.subplots(len(theta_mins)</span><span class="s0">, </span><span class="s1">len(theta_maxs)</span><span class="s0">,</span>
                            <span class="s1">subplot_kw={</span><span class="s2">'polar'</span><span class="s1">: </span><span class="s0">True</span><span class="s1">}</span><span class="s0">,</span>
                            <span class="s1">figsize=(</span><span class="s3">8</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>

    <span class="s0">for </span><span class="s1">i</span><span class="s0">, </span><span class="s1">start </span><span class="s0">in </span><span class="s1">enumerate(theta_mins):</span>
        <span class="s0">for </span><span class="s1">j</span><span class="s0">, </span><span class="s1">end </span><span class="s0">in </span><span class="s1">enumerate(theta_maxs):</span>
            <span class="s1">ax = axs[i</span><span class="s0">, </span><span class="s1">j]</span>
            <span class="s1">ax.plot(theta</span><span class="s0">, </span><span class="s1">r)</span>
            <span class="s0">if </span><span class="s1">start &lt; end:</span>
                <span class="s1">ax.set_thetamin(start)</span>
                <span class="s1">ax.set_thetamax(end)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s4"># Plot with clockwise orientation instead.</span>
                <span class="s1">ax.set_thetamin(end)</span>
                <span class="s1">ax.set_thetamax(start)</span>
                <span class="s1">ax.set_theta_direction(</span><span class="s2">'clockwise'</span><span class="s1">)</span>
            <span class="s1">ax.tick_params(tick1On=</span><span class="s0">True, </span><span class="s1">tick2On=</span><span class="s0">True,</span>
                           <span class="s1">direction=DIRECTIONS[i % len(DIRECTIONS)]</span><span class="s0">,</span>
                           <span class="s1">rotation=</span><span class="s2">'auto'</span><span class="s1">)</span>
            <span class="s1">ax.yaxis.set_tick_params(label2On=</span><span class="s0">True, </span><span class="s1">rotation=</span><span class="s2">'auto'</span><span class="s1">)</span>
            <span class="s1">ax.xaxis.get_major_locator().base.set_params(  </span><span class="s4"># backcompat</span>
                <span class="s1">steps=[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2.5</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span>


<span class="s1">@check_figures_equal(extensions=[</span><span class="s2">&quot;png&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_polar_rlim(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s1">ax = fig_test.subplots(subplot_kw={</span><span class="s2">'polar'</span><span class="s1">: </span><span class="s0">True</span><span class="s1">})</span>
    <span class="s1">ax.set_rlim(top=</span><span class="s3">10</span><span class="s1">)</span>
    <span class="s1">ax.set_rlim(bottom=</span><span class="s3">.5</span><span class="s1">)</span>

    <span class="s1">ax = fig_ref.subplots(subplot_kw={</span><span class="s2">'polar'</span><span class="s1">: </span><span class="s0">True</span><span class="s1">})</span>
    <span class="s1">ax.set_rmax(</span><span class="s3">10.</span><span class="s1">)</span>
    <span class="s1">ax.set_rmin(</span><span class="s3">.5</span><span class="s1">)</span>


<span class="s1">@check_figures_equal(extensions=[</span><span class="s2">&quot;png&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_polar_rlim_bottom(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s1">ax = fig_test.subplots(subplot_kw={</span><span class="s2">'polar'</span><span class="s1">: </span><span class="s0">True</span><span class="s1">})</span>
    <span class="s1">ax.set_rlim(bottom=[</span><span class="s3">.5</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span>

    <span class="s1">ax = fig_ref.subplots(subplot_kw={</span><span class="s2">'polar'</span><span class="s1">: </span><span class="s0">True</span><span class="s1">})</span>
    <span class="s1">ax.set_rmax(</span><span class="s3">10.</span><span class="s1">)</span>
    <span class="s1">ax.set_rmin(</span><span class="s3">.5</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_polar_rlim_zero():</span>
    <span class="s1">ax = plt.figure().add_subplot(projection=</span><span class="s2">'polar'</span><span class="s1">)</span>
    <span class="s1">ax.plot(np.arange(</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.arange(</span><span class="s3">10</span><span class="s1">) + </span><span class="s3">.01</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">ax.get_ylim()[</span><span class="s3">0</span><span class="s1">] == </span><span class="s3">0</span>


<span class="s0">def </span><span class="s1">test_polar_no_data():</span>
    <span class="s1">plt.subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax = plt.gca()</span>
    <span class="s0">assert </span><span class="s1">ax.get_rmin() == </span><span class="s3">0 </span><span class="s0">and </span><span class="s1">ax.get_rmax() == </span><span class="s3">1</span>
    <span class="s1">plt.close(</span><span class="s2">&quot;all&quot;</span><span class="s1">)</span>
    <span class="s4"># Used to behave differently (by triggering an autoscale with no data).</span>
    <span class="s1">plt.polar()</span>
    <span class="s1">ax = plt.gca()</span>
    <span class="s0">assert </span><span class="s1">ax.get_rmin() == </span><span class="s3">0 </span><span class="s0">and </span><span class="s1">ax.get_rmax() == </span><span class="s3">1</span>


<span class="s0">def </span><span class="s1">test_polar_default_log_lims():</span>
    <span class="s1">plt.subplot(projection=</span><span class="s2">'polar'</span><span class="s1">)</span>
    <span class="s1">ax = plt.gca()</span>
    <span class="s1">ax.set_rscale(</span><span class="s2">'log'</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">ax.get_rmin() &gt; </span><span class="s3">0</span>


<span class="s0">def </span><span class="s1">test_polar_not_datalim_adjustable():</span>
    <span class="s1">ax = plt.figure().add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">ax.set_adjustable(</span><span class="s2">&quot;datalim&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_polar_gridlines():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_subplot(polar=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s4"># make all major grid lines lighter, only x grid lines set in 2.1.0</span>
    <span class="s1">ax.grid(alpha=</span><span class="s3">0.2</span><span class="s1">)</span>
    <span class="s4"># hide y tick labels, no effect in 2.1.0</span>
    <span class="s1">plt.setp(ax.yaxis.get_ticklabels()</span><span class="s0">, </span><span class="s1">visible=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">fig.canvas.draw()</span>
    <span class="s0">assert </span><span class="s1">ax.xaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].gridline.get_alpha() == </span><span class="s3">.2</span>
    <span class="s0">assert </span><span class="s1">ax.yaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].gridline.get_alpha() == </span><span class="s3">.2</span>


<span class="s0">def </span><span class="s1">test_get_tightbbox_polar():</span>
    <span class="s1">fig</span><span class="s0">, </span><span class="s1">ax = plt.subplots(subplot_kw={</span><span class="s2">'projection'</span><span class="s1">: </span><span class="s2">'polar'</span><span class="s1">})</span>
    <span class="s1">fig.canvas.draw()</span>
    <span class="s1">bb = ax.get_tightbbox(fig.canvas.get_renderer())</span>
    <span class="s1">assert_allclose(</span>
        <span class="s1">bb.extents</span><span class="s0">, </span><span class="s1">[</span><span class="s3">107.7778</span><span class="s0">,  </span><span class="s3">29.2778</span><span class="s0">, </span><span class="s3">539.7847</span><span class="s0">, </span><span class="s3">450.7222</span><span class="s1">]</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-03</span><span class="s1">)</span>


<span class="s1">@check_figures_equal(extensions=[</span><span class="s2">&quot;png&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_polar_interpolation_steps_constant_r(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s4"># Check that an extra half-turn doesn't make any difference -- modulo</span>
    <span class="s4"># antialiasing, which we disable here.</span>
    <span class="s1">p1 = (fig_test.add_subplot(</span><span class="s3">121</span><span class="s0">, </span><span class="s1">projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
          <span class="s1">.bar([</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">*np.pi</span><span class="s0">, </span><span class="s1">edgecolor=</span><span class="s2">&quot;none&quot;</span><span class="s0">, </span><span class="s1">antialiased=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">p2 = (fig_test.add_subplot(</span><span class="s3">122</span><span class="s0">, </span><span class="s1">projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
          <span class="s1">.bar([</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3</span><span class="s1">*np.pi</span><span class="s0">, </span><span class="s1">edgecolor=</span><span class="s2">&quot;none&quot;</span><span class="s0">, </span><span class="s1">antialiased=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">p3 = (fig_ref.add_subplot(</span><span class="s3">121</span><span class="s0">, </span><span class="s1">projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
          <span class="s1">.bar([</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s3">2</span><span class="s1">*np.pi</span><span class="s0">, </span><span class="s1">edgecolor=</span><span class="s2">&quot;none&quot;</span><span class="s0">, </span><span class="s1">antialiased=</span><span class="s0">False</span><span class="s1">))</span>
    <span class="s1">p4 = (fig_ref.add_subplot(</span><span class="s3">122</span><span class="s0">, </span><span class="s1">projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
          <span class="s1">.bar([</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">*np.pi</span><span class="s0">, </span><span class="s1">edgecolor=</span><span class="s2">&quot;none&quot;</span><span class="s0">, </span><span class="s1">antialiased=</span><span class="s0">False</span><span class="s1">))</span>


<span class="s1">@check_figures_equal(extensions=[</span><span class="s2">&quot;png&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_polar_interpolation_steps_variable_r(fig_test</span><span class="s0">, </span><span class="s1">fig_ref):</span>
    <span class="s1">l</span><span class="s0">, </span><span class="s1">= fig_test.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">).plot([</span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.pi/</span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">l.get_path()._interpolation_steps = </span><span class="s3">100</span>
    <span class="s1">fig_ref.add_subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">).plot(</span>
        <span class="s1">np.linspace(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.pi/</span><span class="s3">2</span><span class="s0">, </span><span class="s3">101</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.linspace(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">101</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">test_thetalim_valid_invalid():</span>
    <span class="s1">ax = plt.subplot(projection=</span><span class="s2">'polar'</span><span class="s1">)</span>
    <span class="s1">ax.set_thetalim(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">* np.pi)  </span><span class="s4"># doesn't raise.</span>
    <span class="s1">ax.set_thetalim(thetamin=</span><span class="s3">800</span><span class="s0">, </span><span class="s1">thetamax=</span><span class="s3">440</span><span class="s1">)  </span><span class="s4"># doesn't raise.</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">,</span>
                       <span class="s1">match=</span><span class="s2">'angle range must be less than a full circle'</span><span class="s1">):</span>
        <span class="s1">ax.set_thetalim(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3 </span><span class="s1">* np.pi)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">,</span>
                       <span class="s1">match=</span><span class="s2">'angle range must be less than a full circle'</span><span class="s1">):</span>
        <span class="s1">ax.set_thetalim(thetamin=</span><span class="s3">800</span><span class="s0">, </span><span class="s1">thetamax=</span><span class="s3">400</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_thetalim_args():</span>
    <span class="s1">ax = plt.subplot(projection=</span><span class="s2">'polar'</span><span class="s1">)</span>
    <span class="s1">ax.set_thetalim(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">tuple(np.radians((ax.get_thetamin()</span><span class="s0">, </span><span class="s1">ax.get_thetamax()))) == (</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">ax.set_thetalim((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s0">assert </span><span class="s1">tuple(np.radians((ax.get_thetamin()</span><span class="s0">, </span><span class="s1">ax.get_thetamax()))) == (</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_default_thetalocator():</span>
    <span class="s4"># Ideally we would check AAAABBC, but the smallest axes currently puts a</span>
    <span class="s4"># single tick at 150° because MaxNLocator doesn't have a way to accept 15°</span>
    <span class="s4"># while rejecting 150°.</span>
    <span class="s1">fig</span><span class="s0">, </span><span class="s1">axs = plt.subplot_mosaic(</span>
        <span class="s2">&quot;AAAABB.&quot;</span><span class="s0">, </span><span class="s1">subplot_kw={</span><span class="s2">&quot;projection&quot;</span><span class="s1">: </span><span class="s2">&quot;polar&quot;</span><span class="s1">})</span>
    <span class="s0">for </span><span class="s1">ax </span><span class="s0">in </span><span class="s1">axs.values():</span>
        <span class="s1">ax.set_thetalim(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.pi)</span>
    <span class="s0">for </span><span class="s1">ax </span><span class="s0">in </span><span class="s1">axs.values():</span>
        <span class="s1">ticklocs = np.degrees(ax.xaxis.get_majorticklocs()).tolist()</span>
        <span class="s0">assert </span><span class="s1">pytest.approx(</span><span class="s3">90</span><span class="s1">) </span><span class="s0">in </span><span class="s1">ticklocs</span>
        <span class="s0">assert </span><span class="s1">pytest.approx(</span><span class="s3">100</span><span class="s1">) </span><span class="s0">not in </span><span class="s1">ticklocs</span>


<span class="s0">def </span><span class="s1">test_axvspan():</span>
    <span class="s1">ax = plt.subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">span = ax.axvspan(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.pi/</span><span class="s3">4</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">span.get_path()._interpolation_steps &gt; </span><span class="s3">1</span>


<span class="s1">@check_figures_equal(extensions=[</span><span class="s2">&quot;png&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_remove_shared_polar(fig_ref</span><span class="s0">, </span><span class="s1">fig_test):</span>
    <span class="s4"># Removing shared polar axes used to crash.  Test removing them, keeping in</span>
    <span class="s4"># both cases just the lower left axes of a grid to avoid running into a</span>
    <span class="s4"># separate issue (now being fixed) of ticklabel visibility for shared axes.</span>
    <span class="s1">axs = fig_ref.subplots(</span>
        <span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">sharex=</span><span class="s0">True, </span><span class="s1">subplot_kw={</span><span class="s2">&quot;projection&quot;</span><span class="s1">: </span><span class="s2">&quot;polar&quot;</span><span class="s1">})</span>
    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]:</span>
        <span class="s1">axs.flat[i].remove()</span>
    <span class="s1">axs = fig_test.subplots(</span>
        <span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">sharey=</span><span class="s0">True, </span><span class="s1">subplot_kw={</span><span class="s2">&quot;projection&quot;</span><span class="s1">: </span><span class="s2">&quot;polar&quot;</span><span class="s1">})</span>
    <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]:</span>
        <span class="s1">axs.flat[i].remove()</span>


<span class="s0">def </span><span class="s1">test_shared_polar_keeps_ticklabels():</span>
    <span class="s1">fig</span><span class="s0">, </span><span class="s1">axs = plt.subplots(</span>
        <span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">subplot_kw={</span><span class="s2">&quot;projection&quot;</span><span class="s1">: </span><span class="s2">&quot;polar&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">sharex=</span><span class="s0">True, </span><span class="s1">sharey=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">fig.canvas.draw()</span>
    <span class="s0">assert </span><span class="s1">axs[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">].xaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].get_visible()</span>
    <span class="s0">assert </span><span class="s1">axs[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">].yaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].get_visible()</span>
    <span class="s1">fig</span><span class="s0">, </span><span class="s1">axs = plt.subplot_mosaic(</span>
        <span class="s2">&quot;ab</span><span class="s0">\n</span><span class="s2">cd&quot;</span><span class="s0">, </span><span class="s1">subplot_kw={</span><span class="s2">&quot;projection&quot;</span><span class="s1">: </span><span class="s2">&quot;polar&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">sharex=</span><span class="s0">True, </span><span class="s1">sharey=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">fig.canvas.draw()</span>
    <span class="s0">assert </span><span class="s1">axs[</span><span class="s2">&quot;b&quot;</span><span class="s1">].xaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].get_visible()</span>
    <span class="s0">assert </span><span class="s1">axs[</span><span class="s2">&quot;b&quot;</span><span class="s1">].yaxis.majorTicks[</span><span class="s3">0</span><span class="s1">].get_visible()</span>


<span class="s0">def </span><span class="s1">test_axvline_axvspan_do_not_modify_rlims():</span>
    <span class="s1">ax = plt.subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s1">ax.axvspan(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">ax.axvline(</span><span class="s3">.5</span><span class="s1">)</span>
    <span class="s1">ax.plot([</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">.2</span><span class="s1">])</span>
    <span class="s0">assert </span><span class="s1">ax.get_ylim() == (</span><span class="s3">0</span><span class="s0">, </span><span class="s3">.2</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_cursor_precision():</span>
    <span class="s1">ax = plt.subplot(projection=</span><span class="s2">&quot;polar&quot;</span><span class="s1">)</span>
    <span class="s4"># Higher radii correspond to higher theta-precisions.</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">) == </span><span class="s2">&quot;θ=0π (0°), r=0.000&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.00π (0°), r=0.100&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.000π (0.0°), r=1.000&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">) == </span><span class="s2">&quot;θ=0.3π (57°), r=0.000&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.32π (57°), r=0.100&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.318π (57.3°), r=1.000&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">) == </span><span class="s2">&quot;θ=0.6π (115°), r=0.000&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">.1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.64π (115°), r=0.100&quot;</span>
    <span class="s0">assert </span><span class="s1">ax.format_coord(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) == </span><span class="s2">&quot;θ=0.637π (114.6°), r=1.000&quot;</span>


<span class="s1">@image_comparison([</span><span class="s2">'polar_log.png'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">style=</span><span class="s2">'default'</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_polar_log():</span>
    <span class="s1">fig = plt.figure()</span>
    <span class="s1">ax = fig.add_subplot(polar=</span><span class="s0">True</span><span class="s1">)</span>

    <span class="s1">ax.set_rscale(</span><span class="s2">'log'</span><span class="s1">)</span>
    <span class="s1">ax.set_rlim(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">)</span>

    <span class="s1">n = </span><span class="s3">100</span>
    <span class="s1">ax.plot(np.linspace(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">* np.pi</span><span class="s0">, </span><span class="s1">n)</span><span class="s0">, </span><span class="s1">np.logspace(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">n))</span>
</pre>
</body>
</html>