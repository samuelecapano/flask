<html>
<head>
<title>media_sequence.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
media_sequence.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Copyright 2019 The MediaPipe Authors. 
 
Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); 
you may not use this file except in compliance with the License. 
You may obtain a copy of the License at 
 
     http://www.apache.org/licenses/LICENSE-2.0 
 
Unless required by applicable law or agreed to in writing, software 
distributed under the License is distributed on an &quot;AS IS&quot; BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
See the License for the specific language governing permissions and 
limitations under the License. 
 
 
This script defines a large number of getters and setters for storing 
multimedia, such as video or audio, and related machine learning data in 
tf.train.SequenceExamples. These getters and setters simplify sharing 
data by enforcing common patterns for storing data in SequenceExample 
key-value pairs. 
 
The constants, macros, and functions are organized into 6 groups: clip 
metadata, clip label related, segment related, bounding-box related, image 
related, feature list related, and keyframe related. The following examples 
will walk through common task structures, but the relevant data to store can 
vary by task. 
 
The clip metadata group is generally data about the media and stored in the 
SequenceExample.context. Specifying the metadata enables media pipelines, 
such as MediaPipe, to retrieve that data. Typically, set_clip_data_path, 
set_clip_start_timestamp, and set_clip_end_timestamp define which data to use 
without storing the data itself. Example: 
  tensorflow.train.SequenceExample sequence 
  set_clip_data_path(&quot;/relative/path/to/data.mp4&quot;, sequence) 
  set_clip_start_timestamp(0, sequence) 
  set_clip_end_timestamp(10000000, sequence)  # 10 seconds in microseconds. 
 
The clip label group adds labels that apply to the entire media clip. To 
annotate that a video clip has a particular label, set the clip metadata 
above and also set the set_clip_label_index and set_clip_label_string. Most 
training pipelines will only use the label index or string, but we recommend 
storing both to improve readability while maintaining ease of use. 
Example: 
  set_clip_label_string((&quot;run&quot;, &quot;jump&quot;), sequence) 
  set_Clip_label_index((35, 47), sequence) 
 
The segment group is generally data about time spans within the media clip 
and stored in the SequenceExample.context. In this code, continuous lengths 
of media are called clips, and each clip may have subregions of interest that 
are called segments. To annotate that a video clip has time spans with labels 
set the clip metadata above and use the functions set_segment_start_timestamp, 
set_segment_end_timestamp, set_segment_label_index, and 
set_segment_label_string. Most training pipelines will only use the label index 
or string, but we recommend storing both to improve readability while 
maintaining ease of use. By listing segments as times, the frame rate or other 
properties can change without affecting the labels. 
Example: 
  set_segment_start_timestamp((500000, 1000000), sequence)  # in microseconds 
  set_segment_end_timestamp((2000000, 6000000), sequence) 
  set_segment_label_index((35, 47), sequence) 
  set_segment_label_string((&quot;run&quot;, &quot;jump&quot;), sequence) 
 
The bounding box group is useful for identifying spatio-temporal annotations 
for detection, tracking, or action recognition. The exact keys that are 
needed can vary by task, but to annotate a video clip for detection set the 
clip metadata above and use repeatedly call add_bbox, add_bbox_timestamp, 
add_bbox_label_index, and add_bbox_label_string. Most training pipelines will 
only use the label index or string, but we recommend storing both to improve 
readability while maintaining ease of use. Because bounding boxes are 
assigned to timepoints in a video, changing the image frame rate can can 
change the alignment. The media_sequence.h's ReconcileMetadata function can 
align bounding boxes to the nearest image. 
 
The image group is useful for storing data as sequential 2D arrays, typically 
encoded as bytes. Images can be RGB images stored as JPEG, discrete masks 
stored as PNG, or some other format. Parameters that are static over time are 
set in the context using set_image_width, set_image_height, set_image_format, 
etc. The series of frames and timestamps are then added with add_image_encoded 
and 
add_image_timestamp. For discrete masks, the class or instance indices can be 
mapped to labels or classes using 
set_class_segmentation_class_label_{index,string} and 
set_instance_segmentation_object_class_index. 
 
The feature list group is useful for storing audio and extracted features, 
such as per-frame embeddings. SequenceExamples only store lists of floats per 
timestep, so the dimensions are stored in the context to enable reshaping. 
For example, set_feature_dimensions and repeatedly calling add_feature_floats 
and add_feature_timestamp adds per-frame embeddings. The feature methods also 
support audio features. 
 
Macros for common patterns are created in media_sequence_util.py and are used 
here extensively. Because these macros are formulaic, I will only include a 
usage example here in the code rather than repeating documentation for every 
instance. This header defines additional functions to simplify working with 
MediaPipe types. 
 
Each msu.create_{TYPE}_context_feature takes a NAME and a KEY. It provides 
setters and getters for SequenceExamples and stores a single value under KEY 
in the context field. The provided functions are has_${NAME}, get_${NAME}, 
set_${Name}, and clear_${NAME}. 
Eg. 
  tf.train.SequenceExample example 
  set_data_path(&quot;data_path&quot;, example) 
  if has_data_path(example): 
     data_path = get_data_path(example) 
     clear_data_path(example) 
 
Each msu.create_{TYPE}_list_context_feature takes a NAME and a KEY. It provides 
setters and getters for SequenceExamples and stores a sequence of values 
under KEY in the context field. The provided functions are has_${NAME}, 
get_${NAME}, set_${Name}, clear_${NAME}, get_${NAME}_at, and add_${NAME}. 
Eg. 
  tf.train.SequenceExample example 
  set_clip_label_string((&quot;run&quot;, &quot;jump&quot;), example) 
  if has_clip_label_string(example): 
     values = get_clip_label_string(example) 
     clear_clip_label_string(example) 
 
Each msu.create_{TYPE}_feature_list takes a NAME and a KEY. It provides setters 
and getters for SequenceExamples and stores a single value in each feature field 
under KEY of the feature_lists field. The provided functions are has_${NAME}, 
get_${NAME}, clear_${NAME}, get_${NAME}_size, get_${NAME}_at, and add_${NAME}. 
  tf.train.SequenceExample example 
  add_image_timestamp(1000000, example) 
  add_image_timestamp(2000000, example) 
  if has_image_timestamp(example): 
    for i in range(get_image_timestamp_size()): 
      timestamp = get_image_timestamp_at(example, i) 
    clear_image_timestamp(example) 
 
Each VECTOR_{TYPE}_FEATURE_LIST takes a NAME and a KEY. It provides setters 
and getters for SequenceExamples and stores a sequence of values in each 
feature field under KEY of the feature_lists field. The provided functions 
are Has${NAME}, Get${NAME}, Clear${NAME}, Get${NAME}Size, Get${NAME}At, and 
Add${NAME}. 
  tf.train.SequenceExample example 
  add_bbox_label_string((&quot;run&quot;, &quot;jump&quot;), example) 
  add_bbox_label_string((&quot;run&quot;, &quot;fall&quot;), example) 
  if has_bbox_label_string(example): 
    for i in range(get_bbox_label_string_size(example)): 
      labels = get_bbox_label_string_at(example, i) 
    clear_bbox_label_string(example) 
 
As described in media_sequence_util.h, each of these functions can take an 
additional string prefix argument as their first argument. The prefix can 
be fixed with a new NAME by using functools.partial. Prefixes are used to 
identify common storage patterns (e.g. storing an image along with the height 
and width) under different names (e.g. storing a left and right image in a 
stereo pair.) An example creating functions such as 
add_left_image_encoded that adds a string under the key &quot;LEFT/image/encoded&quot; 
 add_left_image_encoded = msu.function_with_default(add_image_encoded, &quot;LEFT&quot;) 
&quot;&quot;&quot;</span>

<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">absolute_import</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">division</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">print_function</span>
<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">from </span><span class="s1">mediapipe.util.sequence </span><span class="s2">import </span><span class="s1">media_sequence_util</span>
<span class="s1">msu = media_sequence_util</span>

<span class="s1">_HAS_DYNAMIC_ATTRIBUTES = </span><span class="s2">True</span>

<span class="s3">##################################  METADATA  #################################</span>
<span class="s3"># A unique identifier for each example.</span>
<span class="s1">EXAMPLE_ID_KEY = </span><span class="s4">&quot;example/id&quot;</span>
<span class="s3"># The name o fthe data set, including the version.</span>
<span class="s1">EXAMPLE_DATASET_NAME_KEY = </span><span class="s4">&quot;example/dataset_name&quot;</span>
<span class="s3"># String flags or attributes for this example within a data set.</span>
<span class="s1">EXAMPLE_DATASET_FLAG_STRING_KEY = </span><span class="s4">&quot;example/dataset/flag/string&quot;</span>
<span class="s3"># The relative path to the data on disk from some root directory.</span>
<span class="s1">CLIP_DATA_PATH_KEY = </span><span class="s4">&quot;clip/data_path&quot;</span>
<span class="s3"># Any identifier for the media beyond the data path.</span>
<span class="s1">CLIP_MEDIA_ID_KEY = </span><span class="s4">&quot;clip/media_id&quot;</span>
<span class="s3"># Yet another alternative identifier.</span>
<span class="s1">ALTERNATIVE_CLIP_MEDIA_ID_KEY = </span><span class="s4">&quot;clip/alternative_media_id&quot;</span>
<span class="s3"># The encoded bytes for storing media directly in the SequenceExample.</span>
<span class="s1">CLIP_ENCODED_MEDIA_BYTES_KEY = </span><span class="s4">&quot;clip/encoded_media_bytes&quot;</span>
<span class="s3"># The start time for the encoded media if not preserved during encoding.</span>
<span class="s1">CLIP_ENCODED_MEDIA_START_TIMESTAMP_KEY = </span><span class="s4">&quot;clip/encoded_media_start_timestamp&quot;</span>
<span class="s3"># The start time, in microseconds, for the start of the clip in the media.</span>
<span class="s1">CLIP_START_TIMESTAMP_KEY = </span><span class="s4">&quot;clip/start/timestamp&quot;</span>
<span class="s3"># The end time, in microseconds, for the end of the clip in the media.</span>
<span class="s1">CLIP_END_TIMESTAMP_KEY = </span><span class="s4">&quot;clip/end/timestamp&quot;</span>
<span class="s3"># A list of label indices for this clip.</span>
<span class="s1">CLIP_LABEL_INDEX_KEY = </span><span class="s4">&quot;clip/label/index&quot;</span>
<span class="s3"># A list of label strings for this clip.</span>
<span class="s1">CLIP_LABEL_STRING_KEY = </span><span class="s4">&quot;clip/label/string&quot;</span>
<span class="s3"># A list of label confidences for this clip.</span>
<span class="s1">CLIP_LABEL_CONFIDENCE_KEY = </span><span class="s4">&quot;clip/label/confidence&quot;</span>
<span class="s3"># A list of label start timestamps for this clip.</span>
<span class="s1">CLIP_LABEL_START_TIMESTAMP_KEY = </span><span class="s4">&quot;clip/label/start/timestamp&quot;</span>
<span class="s3"># A list of label end timestamps for this clip.</span>
<span class="s1">CLIP_LABEL_END_TIMESTAMP_KEY = </span><span class="s4">&quot;clip/label/end/timestamp&quot;</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;example_id&quot;</span><span class="s2">, </span><span class="s1">EXAMPLE_ID_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;example_dataset_name&quot;</span><span class="s2">, </span><span class="s1">EXAMPLE_DATASET_NAME_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_list_context_feature(</span>
    <span class="s4">&quot;example_dataset_flag_string&quot;</span><span class="s2">, </span><span class="s1">EXAMPLE_DATASET_FLAG_STRING_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;clip_media_id&quot;</span><span class="s2">, </span><span class="s1">CLIP_MEDIA_ID_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;clip_alternative_media_id&quot;</span><span class="s2">, </span><span class="s1">ALTERNATIVE_CLIP_MEDIA_ID_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;clip_encoded_media_bytes&quot;</span><span class="s2">, </span><span class="s1">CLIP_ENCODED_MEDIA_BYTES_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;clip_data_path&quot;</span><span class="s2">, </span><span class="s1">CLIP_DATA_PATH_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_context_feature(</span>
    <span class="s4">&quot;clip_encoded_media_start_timestamp&quot;</span><span class="s2">,</span>
    <span class="s1">CLIP_ENCODED_MEDIA_START_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_context_feature(</span>
    <span class="s4">&quot;clip_start_timestamp&quot;</span><span class="s2">, </span><span class="s1">CLIP_START_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_context_feature(</span>
    <span class="s4">&quot;clip_end_timestamp&quot;</span><span class="s2">, </span><span class="s1">CLIP_END_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_list_context_feature(</span>
    <span class="s4">&quot;clip_label_string&quot;</span><span class="s2">, </span><span class="s1">CLIP_LABEL_STRING_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;clip_label_index&quot;</span><span class="s2">, </span><span class="s1">CLIP_LABEL_INDEX_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_context_feature(</span>
    <span class="s4">&quot;clip_label_confidence&quot;</span><span class="s2">, </span><span class="s1">CLIP_LABEL_CONFIDENCE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;clip_label_start_timestamp&quot;</span><span class="s2">,</span>
    <span class="s1">CLIP_LABEL_START_TIMESTAMP_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;clip_label_end_timestamp&quot;</span><span class="s2">,</span>
    <span class="s1">CLIP_LABEL_END_TIMESTAMP_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>

<span class="s3">##################################  SEGMENTS  #################################</span>
<span class="s3"># A list of segment start times in microseconds.</span>
<span class="s1">SEGMENT_START_TIMESTAMP_KEY = </span><span class="s4">&quot;segment/start/timestamp&quot;</span>
<span class="s3"># A list of indices marking the first frame index &gt;= the start timestamp.</span>
<span class="s1">SEGMENT_START_INDEX_KEY = </span><span class="s4">&quot;segment/start/index&quot;</span>
<span class="s3"># A list of segment end times in microseconds.</span>
<span class="s1">SEGMENT_END_TIMESTAMP_KEY = </span><span class="s4">&quot;segment/end/timestamp&quot;</span>
<span class="s3"># A list of indices marking the last frame index &lt;= the end timestamp.</span>
<span class="s1">SEGMENT_END_INDEX_KEY = </span><span class="s4">&quot;segment/end/index&quot;</span>
<span class="s3"># A list with the label index for each segment.</span>
<span class="s3"># Multiple labels for the same segment are encoded as repeated segments.</span>
<span class="s1">SEGMENT_LABEL_INDEX_KEY = </span><span class="s4">&quot;segment/label/index&quot;</span>
<span class="s3"># A list with the label string for each segment.</span>
<span class="s3"># Multiple labels for the same segment are encoded as repeated segments.</span>
<span class="s1">SEGMENT_LABEL_STRING_KEY = </span><span class="s4">&quot;segment/label/string&quot;</span>
<span class="s3"># A list with the label confidence for each segment.</span>
<span class="s3"># Multiple labels for the same segment are encoded as repeated segments.</span>
<span class="s1">SEGMENT_LABEL_CONFIDENCE_KEY = </span><span class="s4">&quot;segment/label/confidence&quot;</span>
<span class="s1">msu.create_bytes_list_context_feature(</span>
    <span class="s4">&quot;segment_label_string&quot;</span><span class="s2">, </span><span class="s1">SEGMENT_LABEL_STRING_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;segment_start_timestamp&quot;</span><span class="s2">,</span>
    <span class="s1">SEGMENT_START_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;segment_start_index&quot;</span><span class="s2">, </span><span class="s1">SEGMENT_START_INDEX_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;segment_end_timestamp&quot;</span><span class="s2">, </span><span class="s1">SEGMENT_END_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;segment_end_index&quot;</span><span class="s2">, </span><span class="s1">SEGMENT_END_INDEX_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;segment_label_index&quot;</span><span class="s2">, </span><span class="s1">SEGMENT_LABEL_INDEX_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_context_feature(</span>
    <span class="s4">&quot;segment_label_confidence&quot;</span><span class="s2">,</span>
    <span class="s1">SEGMENT_LABEL_CONFIDENCE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>

<span class="s3">##########################  REGIONS / BOUNDING BOXES  #########################</span>

<span class="s3"># Normalized coordinates of bounding boxes are provided in four lists to avoid</span>
<span class="s3"># order ambiguity. We provide additional accessors for complete bounding boxes</span>
<span class="s3"># below.</span>
<span class="s1">REGION_BBOX_YMIN_KEY = </span><span class="s4">&quot;region/bbox/ymin&quot;</span>
<span class="s1">REGION_BBOX_XMIN_KEY = </span><span class="s4">&quot;region/bbox/xmin&quot;</span>
<span class="s1">REGION_BBOX_YMAX_KEY = </span><span class="s4">&quot;region/bbox/ymax&quot;</span>
<span class="s1">REGION_BBOX_XMAX_KEY = </span><span class="s4">&quot;region/bbox/xmax&quot;</span>
<span class="s3"># The point and radius can denote keypoints.</span>
<span class="s1">REGION_POINT_X_KEY = </span><span class="s4">&quot;region/point/x&quot;</span>
<span class="s1">REGION_POINT_Y_KEY = </span><span class="s4">&quot;region/point/y&quot;</span>
<span class="s1">REGION_RADIUS_KEY = </span><span class="s4">&quot;region/radius&quot;</span>
<span class="s3"># The 3D point can denote keypoints.</span>
<span class="s1">REGION_3D_POINT_X_KEY = </span><span class="s4">&quot;region/3d_point/x&quot;</span>
<span class="s1">REGION_3D_POINT_Y_KEY = </span><span class="s4">&quot;region/3d_point/y&quot;</span>
<span class="s1">REGION_3D_POINT_Z_KEY = </span><span class="s4">&quot;region/3d_point/z&quot;</span>
<span class="s3"># The number of regions at that timestep.</span>
<span class="s1">REGION_NUM_REGIONS_KEY = </span><span class="s4">&quot;region/num_regions&quot;</span>
<span class="s3"># Whether that timestep is annotated for regions.</span>
<span class="s3"># (Disambiguates between multiple meanings of num_regions = 0.)</span>
<span class="s1">REGION_IS_ANNOTATED_KEY = </span><span class="s4">&quot;region/is_annotated&quot;</span>
<span class="s3"># A list indicating if each region is generated (1) or manually annotated (0)</span>
<span class="s1">REGION_IS_GENERATED_KEY = </span><span class="s4">&quot;region/is_generated&quot;</span>
<span class="s3"># A list indicating if each region is occluded (1) or visible (0)</span>
<span class="s1">REGION_IS_OCCLUDED_KEY = </span><span class="s4">&quot;region/is_occluded&quot;</span>
<span class="s3"># Lists with a label for each region.</span>
<span class="s3"># Multiple labels for the same region require duplicating the region.</span>
<span class="s1">REGION_LABEL_INDEX_KEY = </span><span class="s4">&quot;region/label/index&quot;</span>
<span class="s1">REGION_LABEL_STRING_KEY = </span><span class="s4">&quot;region/label/string&quot;</span>
<span class="s1">REGION_LABEL_CONFIDENCE_KEY = </span><span class="s4">&quot;region/label/confidence&quot;</span>
<span class="s3"># Lists with a track identifier for each region.</span>
<span class="s3"># Multiple track identifier for the same region require duplicating the region.</span>
<span class="s1">REGION_TRACK_INDEX_KEY = </span><span class="s4">&quot;region/track/index&quot;</span>
<span class="s1">REGION_TRACK_STRING_KEY = </span><span class="s4">&quot;region/track/string&quot;</span>
<span class="s1">REGION_TRACK_CONFIDENCE_KEY = </span><span class="s4">&quot;region/track/confidence&quot;</span>
<span class="s3"># Lists with a class for each region. In general, prefer to use the label</span>
<span class="s3"># fields. These class fields exist to distinguish tracks when different classes</span>
<span class="s3"># have overlapping track ids.</span>
<span class="s1">REGION_CLASS_INDEX_KEY = </span><span class="s4">&quot;region/class/index&quot;</span>
<span class="s1">REGION_CLASS_STRING_KEY = </span><span class="s4">&quot;region/class/string&quot;</span>
<span class="s1">REGION_CLASS_CONFIDENCE_KEY = </span><span class="s4">&quot;region/class/confidence&quot;</span>
<span class="s3"># The timestamp of the region annotation in microseconds.</span>
<span class="s1">REGION_TIMESTAMP_KEY = </span><span class="s4">&quot;region/timestamp&quot;</span>
<span class="s3"># The original timestamp in microseconds for region annotations.</span>
<span class="s3"># If regions are aligned to image frames, this field preserves the original</span>
<span class="s3"># timestamps.</span>
<span class="s1">REGION_UNMODIFIED_TIMESTAMP_KEY = </span><span class="s4">&quot;region/unmodified_timestamp&quot;</span>
<span class="s3"># The list of region parts expected in this example.</span>
<span class="s1">REGION_PARTS_KEY = </span><span class="s4">&quot;region/parts&quot;</span>
<span class="s3"># The dimensions of each embedding per region / bounding box.</span>
<span class="s1">REGION_EMBEDDING_DIMENSIONS_PER_REGION_KEY = (</span>
    <span class="s4">&quot;region/embedding/dimensions_per_region&quot;</span><span class="s1">)</span>
<span class="s3"># The format encoding embeddings as strings.</span>
<span class="s1">REGION_EMBEDDING_FORMAT_KEY = </span><span class="s4">&quot;region/embedding/format&quot;</span>
<span class="s3"># An embedding for each region. The length of each list must be the product of</span>
<span class="s3"># the number of regions and the product of the embedding dimensions.</span>
<span class="s1">REGION_EMBEDDING_FLOAT_KEY = </span><span class="s4">&quot;region/embedding/float&quot;</span>
<span class="s3"># A string encoded embedding for each regions.</span>
<span class="s1">REGION_EMBEDDING_ENCODED_KEY = </span><span class="s4">&quot;region/embedding/encoded&quot;</span>
<span class="s3"># The confidence of the embedding.</span>
<span class="s1">REGION_EMBEDDING_CONFIDENCE_KEY = </span><span class="s4">&quot;region/embedding/confidence&quot;</span>


<span class="s2">def </span><span class="s1">_create_region_with_prefix(name</span><span class="s2">, </span><span class="s1">prefix):</span>
  <span class="s0">&quot;&quot;&quot;Create multiple accessors for region based data.&quot;&quot;&quot;</span>
  <span class="s1">msu.create_int_feature_list(name + </span><span class="s4">&quot;_num_regions&quot;</span><span class="s2">, </span><span class="s1">REGION_NUM_REGIONS_KEY</span><span class="s2">,</span>
                              <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_feature_list(name + </span><span class="s4">&quot;_is_annotated&quot;</span><span class="s2">, </span><span class="s1">REGION_IS_ANNOTATED_KEY</span><span class="s2">,</span>
                              <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_is_occluded&quot;</span><span class="s2">, </span><span class="s1">REGION_IS_OCCLUDED_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_is_generated&quot;</span><span class="s2">, </span><span class="s1">REGION_IS_GENERATED_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_feature_list(name + </span><span class="s4">&quot;_timestamp&quot;</span><span class="s2">, </span><span class="s1">REGION_TIMESTAMP_KEY</span><span class="s2">,</span>
                              <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_unmodified_timestamp&quot;</span><span class="s2">, </span><span class="s1">REGION_UNMODIFIED_TIMESTAMP_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_label_string&quot;</span><span class="s2">, </span><span class="s1">REGION_LABEL_STRING_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_label_index&quot;</span><span class="s2">, </span><span class="s1">REGION_LABEL_INDEX_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_label_confidence&quot;</span><span class="s2">, </span><span class="s1">REGION_LABEL_CONFIDENCE_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_class_string&quot;</span><span class="s2">, </span><span class="s1">REGION_CLASS_STRING_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_class_index&quot;</span><span class="s2">, </span><span class="s1">REGION_CLASS_INDEX_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_class_confidence&quot;</span><span class="s2">, </span><span class="s1">REGION_CLASS_CONFIDENCE_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_track_string&quot;</span><span class="s2">, </span><span class="s1">REGION_TRACK_STRING_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_track_index&quot;</span><span class="s2">, </span><span class="s1">REGION_TRACK_INDEX_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_track_confidence&quot;</span><span class="s2">, </span><span class="s1">REGION_TRACK_CONFIDENCE_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_ymin&quot;</span><span class="s2">, </span><span class="s1">REGION_BBOX_YMIN_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_xmin&quot;</span><span class="s2">, </span><span class="s1">REGION_BBOX_XMIN_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_ymax&quot;</span><span class="s2">, </span><span class="s1">REGION_BBOX_YMAX_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_xmax&quot;</span><span class="s2">, </span><span class="s1">REGION_BBOX_XMAX_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_point_x&quot;</span><span class="s2">, </span><span class="s1">REGION_POINT_X_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_point_y&quot;</span><span class="s2">, </span><span class="s1">REGION_POINT_Y_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_3d_point_x&quot;</span><span class="s2">, </span><span class="s1">REGION_3D_POINT_X_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_3d_point_y&quot;</span><span class="s2">, </span><span class="s1">REGION_3D_POINT_Y_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(</span>
      <span class="s1">name + </span><span class="s4">&quot;_3d_point_z&quot;</span><span class="s2">, </span><span class="s1">REGION_3D_POINT_Z_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_context_feature(name + </span><span class="s4">&quot;_parts&quot;</span><span class="s2">,</span>
                                        <span class="s1">REGION_PARTS_KEY</span><span class="s2">,</span>
                                        <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_context_feature(</span>
      <span class="s1">name + </span><span class="s4">&quot;_embedding_dimensions_per_region&quot;</span><span class="s2">,</span>
      <span class="s1">REGION_EMBEDDING_DIMENSIONS_PER_REGION_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_context_feature(name + </span><span class="s4">&quot;_embedding_format&quot;</span><span class="s2">,</span>
                                   <span class="s1">REGION_EMBEDDING_FORMAT_KEY</span><span class="s2">,</span>
                                   <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_embedding_floats&quot;</span><span class="s2">,</span>
                                     <span class="s1">REGION_EMBEDDING_FLOAT_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_feature_list(name + </span><span class="s4">&quot;_embedding_encoded&quot;</span><span class="s2">,</span>
                                     <span class="s1">REGION_EMBEDDING_ENCODED_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_list_feature_list(name + </span><span class="s4">&quot;_embedding_confidence&quot;</span><span class="s2">,</span>
                                     <span class="s1">REGION_EMBEDDING_CONFIDENCE_KEY</span><span class="s2">,</span>
                                     <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s3"># pylint: disable=undefined-variable</span>
  <span class="s2">def </span><span class="s1">get_prefixed_bbox_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">np.stack((</span>
        <span class="s1">get_bbox_ymin_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_xmin_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_ymax_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_xmax_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix))</span><span class="s2">,</span>
                    <span class="s5">1</span><span class="s1">)</span>
  <span class="s2">def </span><span class="s1">add_prefixed_bbox(values</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">values = np.array(values)</span>
    <span class="s2">if </span><span class="s1">values.size == </span><span class="s5">0</span><span class="s1">:</span>
      <span class="s1">add_bbox_ymin([]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_xmin([]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_ymax([]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_xmax([]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s2">else</span><span class="s1">:</span>
      <span class="s1">add_bbox_ymin(values[:</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_xmin(values[:</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_ymax(values[:</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
      <span class="s1">add_bbox_xmax(values[:</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">get_prefixed_bbox_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">get_bbox_ymin_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">has_prefixed_bbox(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">has_bbox_ymin(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">clear_prefixed_bbox(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">clear_bbox_ymin(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_xmin(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_ymax(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_xmax(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">get_prefixed_point_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">np.stack((</span>
        <span class="s1">get_bbox_point_y_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_point_x_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix))</span><span class="s2">,</span>
                    <span class="s5">1</span><span class="s1">)</span>
  <span class="s2">def </span><span class="s1">add_prefixed_point(values</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">add_bbox_point_y(values[:</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">add_bbox_point_x(values[:</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">get_prefixed_point_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">get_bbox_point_y_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">has_prefixed_point(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">has_bbox_point_y(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">clear_prefixed_point(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">clear_bbox_point_y(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_point_x(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">get_prefixed_3d_point_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">np.stack((</span>
        <span class="s1">get_bbox_3d_point_x_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_3d_point_y_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span><span class="s2">,</span>
        <span class="s1">get_bbox_3d_point_z_at(index</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix))</span><span class="s2">,</span>
                    <span class="s5">1</span><span class="s1">)</span>
  <span class="s2">def </span><span class="s1">add_prefixed_3d_point(values</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">add_bbox_3d_point_x(values[:</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">add_bbox_3d_point_y(values[:</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">add_bbox_3d_point_z(values[:</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">get_prefixed_3d_point_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">get_bbox_3d_point_x_size(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">has_prefixed_3d_point(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s2">return </span><span class="s1">has_bbox_3d_point_x(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s2">def </span><span class="s1">clear_prefixed_3d_point(sequence_example</span><span class="s2">, </span><span class="s1">prefix):</span>
    <span class="s1">clear_bbox_3d_point_x(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_3d_point_y(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
    <span class="s1">clear_bbox_3d_point_z(sequence_example</span><span class="s2">, </span><span class="s1">prefix=prefix)</span>
  <span class="s3"># pylint: enable=undefined-variable</span>
  <span class="s1">msu.add_functions_to_module({</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_at&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_bbox_at</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;add_&quot; </span><span class="s1">+ name:</span>
          <span class="s1">msu.function_with_default(add_prefixed_bbox</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_size&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_bbox_size</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;has_&quot; </span><span class="s1">+ name:</span>
          <span class="s1">msu.function_with_default(has_prefixed_bbox</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;clear_&quot; </span><span class="s1">+ name:</span>
          <span class="s1">msu.function_with_default(clear_prefixed_bbox</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
  <span class="s1">}</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.add_functions_to_module({</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_point_at&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_point_at</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;add_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(add_prefixed_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_point_size&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_point_size</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;has_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(has_prefixed_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;clear_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(clear_prefixed_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
  <span class="s1">}</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.add_functions_to_module({</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_3d_point_at&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_3d_point_at</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;add_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_3d_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(add_prefixed_3d_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;get_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_3d_point_size&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(get_prefixed_3d_point_size</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;has_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_3d_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(has_prefixed_3d_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
      <span class="s4">&quot;clear_&quot; </span><span class="s1">+ name + </span><span class="s4">&quot;_3d_point&quot;</span><span class="s1">:</span>
          <span class="s1">msu.function_with_default(clear_prefixed_3d_point</span><span class="s2">, </span><span class="s1">prefix)</span><span class="s2">,</span>
  <span class="s1">}</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>


<span class="s1">PREDICTED_PREFIX = </span><span class="s4">&quot;PREDICTED&quot;</span>
<span class="s1">_create_region_with_prefix(</span><span class="s4">&quot;bbox&quot;</span><span class="s2">, </span><span class="s4">&quot;&quot;</span><span class="s1">)</span>
<span class="s1">_create_region_with_prefix(</span><span class="s4">&quot;predicted_bbox&quot;</span><span class="s2">, </span><span class="s1">PREDICTED_PREFIX)</span>


<span class="s3">###################################  IMAGES  #################################</span>
<span class="s3"># The format the images are encoded as (e.g. &quot;JPEG&quot;, &quot;PNG&quot;)</span>
<span class="s1">IMAGE_FORMAT_KEY = </span><span class="s4">&quot;image/format&quot;</span>
<span class="s3"># The number of channels in the image.</span>
<span class="s1">IMAGE_CHANNELS_KEY = </span><span class="s4">&quot;image/channels&quot;</span>
<span class="s3"># The colorspace of the iamge.</span>
<span class="s1">IMAGE_COLORSPACE_KEY = </span><span class="s4">&quot;image/colorspace&quot;</span>
<span class="s3"># The height of the image in pixels.</span>
<span class="s1">IMAGE_HEIGHT_KEY = </span><span class="s4">&quot;image/height&quot;</span>
<span class="s3"># The width of the image in pixels.</span>
<span class="s1">IMAGE_WIDTH_KEY = </span><span class="s4">&quot;image/width&quot;</span>
<span class="s3"># frame rate in images/second of media.</span>
<span class="s1">IMAGE_FRAME_RATE_KEY = </span><span class="s4">&quot;image/frame_rate&quot;</span>
<span class="s3"># The maximum values if the images were saturated and normalized for encoding.</span>
<span class="s1">IMAGE_SATURATION_KEY = </span><span class="s4">&quot;image/saturation&quot;</span>
<span class="s3"># The listing from discrete image values (as indices) to class indices.</span>
<span class="s1">IMAGE_CLASS_LABEL_INDEX_KEY = </span><span class="s4">&quot;image/class/label/index&quot;</span>
<span class="s3"># The listing from discrete image values (as indices) to class strings.</span>
<span class="s1">IMAGE_CLASS_LABEL_STRING_KEY = </span><span class="s4">&quot;image/class/label/string&quot;</span>
<span class="s3"># The listing from discrete instance indices to class indices they embody.</span>
<span class="s1">IMAGE_OBJECT_CLASS_INDEX_KEY = </span><span class="s4">&quot;image/object/class/index&quot;</span>
<span class="s3"># The encoded image frame.</span>
<span class="s1">IMAGE_ENCODED_KEY = </span><span class="s4">&quot;image/encoded&quot;</span>
<span class="s3"># Multiple images from the same timestep (e.g. multiview video).</span>
<span class="s1">IMAGE_MULTI_ENCODED_KEY = </span><span class="s4">&quot;image/multi_encoded&quot;</span>
<span class="s3"># The timestamp of the frame in microseconds.</span>
<span class="s1">IMAGE_TIMESTAMP_KEY = </span><span class="s4">&quot;image/timestamp&quot;</span>
<span class="s3"># A per image label if specific frames have labels.</span>
<span class="s3"># If time spans have labels, segments are preferred to allow changing rates.</span>
<span class="s1">IMAGE_LABEL_INDEX_KEY = </span><span class="s4">&quot;image/label/index&quot;</span>
<span class="s1">IMAGE_LABEL_STRING_KEY = </span><span class="s4">&quot;image/label/string&quot;</span>
<span class="s1">IMAGE_LABEL_CONFIDENCE_KEY = </span><span class="s4">&quot;image/label/confidence&quot;</span>
<span class="s3"># The path of the image file if it did not come from a media clip.</span>
<span class="s1">IMAGE_DATA_PATH_KEY = </span><span class="s4">&quot;image/data_path&quot;</span>


<span class="s2">def </span><span class="s1">_create_image_with_prefix(name</span><span class="s2">, </span><span class="s1">prefix):</span>
  <span class="s0">&quot;&quot;&quot;Create multiple accessors for image based data.&quot;&quot;&quot;</span>
  <span class="s1">msu.create_bytes_context_feature(name + </span><span class="s4">&quot;_format&quot;</span><span class="s2">, </span><span class="s1">IMAGE_FORMAT_KEY</span><span class="s2">,</span>
                                   <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_context_feature(name + </span><span class="s4">&quot;_colorspace&quot;</span><span class="s2">, </span><span class="s1">IMAGE_COLORSPACE_KEY</span><span class="s2">,</span>
                                   <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_context_feature(name + </span><span class="s4">&quot;_channels&quot;</span><span class="s2">, </span><span class="s1">IMAGE_CHANNELS_KEY</span><span class="s2">,</span>
                                 <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_context_feature(name + </span><span class="s4">&quot;_height&quot;</span><span class="s2">, </span><span class="s1">IMAGE_HEIGHT_KEY</span><span class="s2">,</span>
                                 <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_context_feature(name + </span><span class="s4">&quot;_width&quot;</span><span class="s2">, </span><span class="s1">IMAGE_WIDTH_KEY</span><span class="s2">,</span>
                                 <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_feature_list(name + </span><span class="s4">&quot;_encoded&quot;</span><span class="s2">, </span><span class="s1">IMAGE_ENCODED_KEY</span><span class="s2">,</span>
                                <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_float_context_feature(name + </span><span class="s4">&quot;_frame_rate&quot;</span><span class="s2">, </span><span class="s1">IMAGE_FRAME_RATE_KEY</span><span class="s2">,</span>
                                   <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_context_feature(</span>
      <span class="s1">name + </span><span class="s4">&quot;_class_label_string&quot;</span><span class="s2">, </span><span class="s1">IMAGE_CLASS_LABEL_STRING_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_context_feature(</span>
      <span class="s1">name + </span><span class="s4">&quot;_class_label_index&quot;</span><span class="s2">, </span><span class="s1">IMAGE_CLASS_LABEL_INDEX_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_list_context_feature(</span>
      <span class="s1">name + </span><span class="s4">&quot;_object_class_index&quot;</span><span class="s2">, </span><span class="s1">IMAGE_OBJECT_CLASS_INDEX_KEY</span><span class="s2">,</span>
      <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_context_feature(name + </span><span class="s4">&quot;_data_path&quot;</span><span class="s2">, </span><span class="s1">IMAGE_DATA_PATH_KEY</span><span class="s2">,</span>
                                   <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_int_feature_list(name + </span><span class="s4">&quot;_timestamp&quot;</span><span class="s2">, </span><span class="s1">IMAGE_TIMESTAMP_KEY</span><span class="s2">,</span>
                              <span class="s1">prefix=prefix</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
  <span class="s1">msu.create_bytes_list_feature_list(name + </span><span class="s4">&quot;_multi_encoded&quot;</span><span class="s2">,</span>
                                     <span class="s1">IMAGE_MULTI_ENCODED_KEY</span><span class="s2">, </span><span class="s1">prefix=prefix</span><span class="s2">,</span>
                                     <span class="s1">module_dict=globals())</span>
<span class="s1">FORWARD_FLOW_PREFIX = </span><span class="s4">&quot;FORWARD_FLOW&quot;</span>
<span class="s1">CLASS_SEGMENTATION_PREFIX = </span><span class="s4">&quot;CLASS_SEGMENTATION&quot;</span>
<span class="s1">INSTANCE_SEGMENTATION_PREFIX = </span><span class="s4">&quot;INSTANCE_SEGMENTATION&quot;</span>
<span class="s1">_create_image_with_prefix(</span><span class="s4">&quot;image&quot;</span><span class="s2">, </span><span class="s4">&quot;&quot;</span><span class="s1">)</span>
<span class="s1">_create_image_with_prefix(</span><span class="s4">&quot;forward_flow&quot;</span><span class="s2">, </span><span class="s1">FORWARD_FLOW_PREFIX)</span>
<span class="s1">_create_image_with_prefix(</span><span class="s4">&quot;class_segmentation&quot;</span><span class="s2">, </span><span class="s1">CLASS_SEGMENTATION_PREFIX)</span>
<span class="s1">_create_image_with_prefix(</span><span class="s4">&quot;instance_segmentation&quot;</span><span class="s2">, </span><span class="s1">INSTANCE_SEGMENTATION_PREFIX)</span>

<span class="s3">##################################  TEXT  #################################</span>
<span class="s3"># Which language text tokens are likely to be in.</span>
<span class="s1">TEXT_LANGUAGE_KEY = </span><span class="s4">&quot;text/language&quot;</span>
<span class="s3"># A large block of text that applies to the media.</span>
<span class="s1">TEXT_CONTEXT_CONTENT_KEY = </span><span class="s4">&quot;text/context/content&quot;</span>

<span class="s3"># The text contents for a given time.</span>
<span class="s1">TEXT_CONTENT_KEY = </span><span class="s4">&quot;text/content&quot;</span>
<span class="s3"># The start time for the text becoming relevant.</span>
<span class="s1">TEXT_TIMESTAMP_KEY = </span><span class="s4">&quot;text/timestamp&quot;</span>
<span class="s3"># The duration where the text is relevant.</span>
<span class="s1">TEXT_DURATION_KEY = </span><span class="s4">&quot;text/duration&quot;</span>
<span class="s3"># The confidence that this is the correct text.</span>
<span class="s1">TEXT_CONFIDENCE_KEY = </span><span class="s4">&quot;text/confidence&quot;</span>
<span class="s3"># A floating point embedding corresponding to the text.</span>
<span class="s1">TEXT_EMBEDDING_KEY = </span><span class="s4">&quot;text/embedding&quot;</span>
<span class="s3"># An integer id corresponding to the text.</span>
<span class="s1">TEXT_TOKEN_ID_KEY = </span><span class="s4">&quot;text/token/id&quot;</span>

<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;text_language&quot;</span><span class="s2">, </span><span class="s1">TEXT_LANGUAGE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;text_context_content&quot;</span><span class="s2">, </span><span class="s1">TEXT_CONTEXT_CONTENT_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_feature_list(</span>
    <span class="s4">&quot;text_content&quot;</span><span class="s2">, </span><span class="s1">TEXT_CONTENT_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_feature_list(</span>
    <span class="s4">&quot;text_timestamp&quot;</span><span class="s2">, </span><span class="s1">TEXT_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_feature_list(</span>
    <span class="s4">&quot;text_duration&quot;</span><span class="s2">, </span><span class="s1">TEXT_DURATION_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_feature_list(</span>
    <span class="s4">&quot;text_confidence&quot;</span><span class="s2">, </span><span class="s1">TEXT_CONFIDENCE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_feature_list(</span>
    <span class="s4">&quot;text_embedding&quot;</span><span class="s2">, </span><span class="s1">TEXT_EMBEDDING_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_feature_list(</span>
    <span class="s4">&quot;text_token_id&quot;</span><span class="s2">, </span><span class="s1">TEXT_TOKEN_ID_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>

<span class="s3">##################################  FEATURES  #################################</span>
<span class="s3"># The dimensions of the feature.</span>
<span class="s1">FEATURE_DIMENSIONS_KEY = </span><span class="s4">&quot;feature/dimensions&quot;</span>
<span class="s3"># The rate the features are extracted per second of media.</span>
<span class="s1">FEATURE_RATE_KEY = </span><span class="s4">&quot;feature/rate&quot;</span>
<span class="s3"># The encoding format if any for the feature.</span>
<span class="s1">FEATURE_BYTES_FORMAT_KEY = </span><span class="s4">&quot;feature/bytes/format&quot;</span>
<span class="s3"># For audio, the rate the samples are extracted per second of media.</span>
<span class="s1">FEATURE_SAMPLE_RATE_KEY = </span><span class="s4">&quot;feature/sample_rate&quot;</span>
<span class="s3"># For audio, the number of channels per extracted feature.</span>
<span class="s1">FEATURE_NUM_CHANNELS_KEY = </span><span class="s4">&quot;feature/num_channels&quot;</span>
<span class="s3"># For audio, th enumber of samples per extracted feature.</span>
<span class="s1">FEATURE_NUM_SAMPLES_KEY = </span><span class="s4">&quot;feature/num_samples&quot;</span>
<span class="s3"># For audio, the rate the features are extracted per second of media.</span>
<span class="s1">FEATURE_PACKET_RATE_KEY = </span><span class="s4">&quot;feature/packet_rate&quot;</span>
<span class="s3"># For audio, the original audio sampling rate the feature is derived from.</span>
<span class="s1">FEATURE_AUDIO_SAMPLE_RATE_KEY = </span><span class="s4">&quot;feature/audio_sample_rate&quot;</span>
<span class="s3"># The feature as a list of floats.</span>
<span class="s1">FEATURE_FLOATS_KEY = </span><span class="s4">&quot;feature/floats&quot;</span>
<span class="s3"># The feature as a list of bytes. May be encoded.</span>
<span class="s1">FEATURE_BYTES_KEY = </span><span class="s4">&quot;feature/bytes&quot;</span>
<span class="s3"># The feature as a list of ints.</span>
<span class="s1">FEATURE_INTS_KEY = </span><span class="s4">&quot;feature/ints&quot;</span>
<span class="s3"># The timestamp, in microseconds, of the feature.</span>
<span class="s1">FEATURE_TIMESTAMP_KEY = </span><span class="s4">&quot;feature/timestamp&quot;</span>
<span class="s3"># It is occasionally useful to indicate that a feature applies to a given range.</span>
<span class="s3"># This should be used for features only and annotations should be provided as</span>
<span class="s3"># segments.</span>
<span class="s1">FEATURE_DURATION_KEY = </span><span class="s4">&quot;feature/duration&quot;</span>
<span class="s3"># Encodes an optional confidence score for the generated features.</span>
<span class="s1">FEATURE_CONFIDENCE_KEY = </span><span class="s4">&quot;feature/confidence&quot;</span>
<span class="s3"># The feature as a list of floats in the context.</span>
<span class="s1">CONTEXT_FEATURE_FLOATS_KEY = </span><span class="s4">&quot;context_feature/floats&quot;</span>
<span class="s3"># The feature as a list of bytes in the context. May be encoded.</span>
<span class="s1">CONTEXT_FEATURE_BYTES_KEY = </span><span class="s4">&quot;context_feature/bytes&quot;</span>
<span class="s3"># The feature as a list of ints in the context.</span>
<span class="s1">CONTEXT_FEATURE_INTS_KEY = </span><span class="s4">&quot;context_feature/ints&quot;</span>

<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;feature_dimensions&quot;</span><span class="s2">, </span><span class="s1">FEATURE_DIMENSIONS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_context_feature(</span>
    <span class="s4">&quot;feature_rate&quot;</span><span class="s2">, </span><span class="s1">FEATURE_RATE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_context_feature(</span>
    <span class="s4">&quot;feature_bytes_format&quot;</span><span class="s2">, </span><span class="s1">FEATURE_BYTES_FORMAT_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_context_feature(</span>
    <span class="s4">&quot;feature_sample_rate&quot;</span><span class="s2">, </span><span class="s1">FEATURE_SAMPLE_RATE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_context_feature(</span>
    <span class="s4">&quot;feature_num_channels&quot;</span><span class="s2">, </span><span class="s1">FEATURE_NUM_CHANNELS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_context_feature(</span>
    <span class="s4">&quot;feature_num_samples&quot;</span><span class="s2">, </span><span class="s1">FEATURE_NUM_SAMPLES_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_context_feature(</span>
    <span class="s4">&quot;feature_packet_rate&quot;</span><span class="s2">, </span><span class="s1">FEATURE_PACKET_RATE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_context_feature(</span>
    <span class="s4">&quot;feature_audio_sample_rate&quot;</span><span class="s2">, </span><span class="s1">FEATURE_AUDIO_SAMPLE_RATE_KEY</span><span class="s2">,</span>
    <span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_feature_list(</span>
    <span class="s4">&quot;feature_floats&quot;</span><span class="s2">, </span><span class="s1">FEATURE_FLOATS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_list_feature_list(</span>
    <span class="s4">&quot;feature_bytes&quot;</span><span class="s2">, </span><span class="s1">FEATURE_BYTES_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_feature_list(</span>
    <span class="s4">&quot;feature_ints&quot;</span><span class="s2">, </span><span class="s1">FEATURE_INTS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_feature_list(</span>
    <span class="s4">&quot;feature_timestamp&quot;</span><span class="s2">, </span><span class="s1">FEATURE_TIMESTAMP_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_feature_list(</span>
    <span class="s4">&quot;feature_duration&quot;</span><span class="s2">, </span><span class="s1">FEATURE_DURATION_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_feature_list(</span>
    <span class="s4">&quot;feature_confidence&quot;</span><span class="s2">, </span><span class="s1">FEATURE_CONFIDENCE_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_float_list_context_feature(</span>
    <span class="s4">&quot;context_feature_floats&quot;</span><span class="s2">, </span><span class="s1">CONTEXT_FEATURE_FLOATS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_bytes_list_context_feature(</span>
    <span class="s4">&quot;context_feature_bytes&quot;</span><span class="s2">, </span><span class="s1">CONTEXT_FEATURE_BYTES_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>
<span class="s1">msu.create_int_list_context_feature(</span>
    <span class="s4">&quot;context_feature_ints&quot;</span><span class="s2">, </span><span class="s1">CONTEXT_FEATURE_INTS_KEY</span><span class="s2">, </span><span class="s1">module_dict=globals())</span>

</pre>
</body>
</html>