<html>
<head>
<title>test_legend3d.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #cc7832;}
.s2 { color: #808080;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_legend3d.py</font>
</center></td></tr></table>
<pre>
<span class="s1">import </span><span class="s0">numpy </span><span class="s1">as </span><span class="s0">np</span>

<span class="s1">from </span><span class="s0">matplotlib.colors </span><span class="s1">import </span><span class="s0">same_color</span>
<span class="s1">from </span><span class="s0">matplotlib.testing.decorators </span><span class="s1">import </span><span class="s0">image_comparison</span>
<span class="s1">import </span><span class="s0">matplotlib.pyplot </span><span class="s1">as </span><span class="s0">plt</span>
<span class="s1">from </span><span class="s0">mpl_toolkits.mplot3d </span><span class="s1">import </span><span class="s0">art3d</span>


<span class="s2"># Update style when regenerating the test image</span>
<span class="s0">@image_comparison([</span><span class="s3">'legend_plot.png'</span><span class="s0">]</span><span class="s1">, </span><span class="s0">remove_text=</span><span class="s1">True,</span>
                  <span class="s0">style=(</span><span class="s3">'classic'</span><span class="s1">, </span><span class="s3">'_classic_test_patch'</span><span class="s0">))</span>
<span class="s1">def </span><span class="s0">test_legend_plot():</span>
    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">x = np.arange(</span><span class="s4">10</span><span class="s0">)</span>
    <span class="s0">ax.plot(x</span><span class="s1">, </span><span class="s4">5 </span><span class="s0">- x</span><span class="s1">, </span><span class="s3">'o'</span><span class="s1">, </span><span class="s0">zdir=</span><span class="s3">'y'</span><span class="s1">, </span><span class="s0">label=</span><span class="s3">'z=1'</span><span class="s0">)</span>
    <span class="s0">ax.plot(x</span><span class="s1">, </span><span class="s0">x - </span><span class="s4">5</span><span class="s1">, </span><span class="s3">'o'</span><span class="s1">, </span><span class="s0">zdir=</span><span class="s3">'y'</span><span class="s1">, </span><span class="s0">label=</span><span class="s3">'z=-1'</span><span class="s0">)</span>
    <span class="s0">ax.legend()</span>


<span class="s2"># Update style when regenerating the test image</span>
<span class="s0">@image_comparison([</span><span class="s3">'legend_bar.png'</span><span class="s0">]</span><span class="s1">, </span><span class="s0">remove_text=</span><span class="s1">True,</span>
                  <span class="s0">style=(</span><span class="s3">'classic'</span><span class="s1">, </span><span class="s3">'_classic_test_patch'</span><span class="s0">))</span>
<span class="s1">def </span><span class="s0">test_legend_bar():</span>
    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">x = np.arange(</span><span class="s4">10</span><span class="s0">)</span>
    <span class="s0">b1 = ax.bar(x</span><span class="s1">, </span><span class="s0">x</span><span class="s1">, </span><span class="s0">zdir=</span><span class="s3">'y'</span><span class="s1">, </span><span class="s0">align=</span><span class="s3">'edge'</span><span class="s1">, </span><span class="s0">color=</span><span class="s3">'m'</span><span class="s0">)</span>
    <span class="s0">b2 = ax.bar(x</span><span class="s1">, </span><span class="s0">x[::-</span><span class="s4">1</span><span class="s0">]</span><span class="s1">, </span><span class="s0">zdir=</span><span class="s3">'x'</span><span class="s1">, </span><span class="s0">align=</span><span class="s3">'edge'</span><span class="s1">, </span><span class="s0">color=</span><span class="s3">'g'</span><span class="s0">)</span>
    <span class="s0">ax.legend([b1[</span><span class="s4">0</span><span class="s0">]</span><span class="s1">, </span><span class="s0">b2[</span><span class="s4">0</span><span class="s0">]]</span><span class="s1">, </span><span class="s0">[</span><span class="s3">'up'</span><span class="s1">, </span><span class="s3">'down'</span><span class="s0">])</span>


<span class="s2"># Update style when regenerating the test image</span>
<span class="s0">@image_comparison([</span><span class="s3">'fancy.png'</span><span class="s0">]</span><span class="s1">, </span><span class="s0">remove_text=</span><span class="s1">True,</span>
                  <span class="s0">style=(</span><span class="s3">'classic'</span><span class="s1">, </span><span class="s3">'_classic_test_patch'</span><span class="s0">))</span>
<span class="s1">def </span><span class="s0">test_fancy():</span>
    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">ax.plot(np.arange(</span><span class="s4">10</span><span class="s0">)</span><span class="s1">, </span><span class="s0">np.full(</span><span class="s4">10</span><span class="s1">, </span><span class="s4">5</span><span class="s0">)</span><span class="s1">, </span><span class="s0">np.full(</span><span class="s4">10</span><span class="s1">, </span><span class="s4">5</span><span class="s0">)</span><span class="s1">, </span><span class="s3">'o--'</span><span class="s1">, </span><span class="s0">label=</span><span class="s3">'line'</span><span class="s0">)</span>
    <span class="s0">ax.scatter(np.arange(</span><span class="s4">10</span><span class="s0">)</span><span class="s1">, </span><span class="s0">np.arange(</span><span class="s4">10</span><span class="s1">, </span><span class="s4">0</span><span class="s1">, </span><span class="s0">-</span><span class="s4">1</span><span class="s0">)</span><span class="s1">, </span><span class="s0">label=</span><span class="s3">'scatter'</span><span class="s0">)</span>
    <span class="s0">ax.errorbar(np.full(</span><span class="s4">10</span><span class="s1">, </span><span class="s4">5</span><span class="s0">)</span><span class="s1">, </span><span class="s0">np.arange(</span><span class="s4">10</span><span class="s0">)</span><span class="s1">, </span><span class="s0">np.full(</span><span class="s4">10</span><span class="s1">, </span><span class="s4">10</span><span class="s0">)</span><span class="s1">,</span>
                <span class="s0">xerr=</span><span class="s4">0.5</span><span class="s1">, </span><span class="s0">zerr=</span><span class="s4">0.5</span><span class="s1">, </span><span class="s0">label=</span><span class="s3">'errorbar'</span><span class="s0">)</span>
    <span class="s0">ax.legend(loc=</span><span class="s3">'lower left'</span><span class="s1">, </span><span class="s0">ncols=</span><span class="s4">2</span><span class="s1">, </span><span class="s0">title=</span><span class="s3">'My legend'</span><span class="s1">, </span><span class="s0">numpoints=</span><span class="s4">1</span><span class="s0">)</span>


<span class="s1">def </span><span class="s0">test_linecollection_scaled_dashes():</span>
    <span class="s0">lines1 = [[(</span><span class="s4">0</span><span class="s1">, </span><span class="s4">.5</span><span class="s0">)</span><span class="s1">, </span><span class="s0">(</span><span class="s4">.5</span><span class="s1">, </span><span class="s4">1</span><span class="s0">)]</span><span class="s1">, </span><span class="s0">[(</span><span class="s4">.3</span><span class="s1">, </span><span class="s4">.6</span><span class="s0">)</span><span class="s1">, </span><span class="s0">(</span><span class="s4">.2</span><span class="s1">, </span><span class="s4">.2</span><span class="s0">)]]</span>
    <span class="s0">lines2 = [[[</span><span class="s4">0.7</span><span class="s1">, </span><span class="s4">.2</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">.8</span><span class="s1">, </span><span class="s4">.4</span><span class="s0">]]</span><span class="s1">, </span><span class="s0">[[</span><span class="s4">.5</span><span class="s1">, </span><span class="s4">.7</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">.6</span><span class="s1">, </span><span class="s4">.1</span><span class="s0">]]]</span>
    <span class="s0">lines3 = [[[</span><span class="s4">0.6</span><span class="s1">, </span><span class="s4">.2</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">.8</span><span class="s1">, </span><span class="s4">.4</span><span class="s0">]]</span><span class="s1">, </span><span class="s0">[[</span><span class="s4">.5</span><span class="s1">, </span><span class="s4">.7</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">.1</span><span class="s1">, </span><span class="s4">.1</span><span class="s0">]]]</span>
    <span class="s0">lc1 = art3d.Line3DCollection(lines1</span><span class="s1">, </span><span class="s0">linestyles=</span><span class="s3">&quot;--&quot;</span><span class="s1">, </span><span class="s0">lw=</span><span class="s4">3</span><span class="s0">)</span>
    <span class="s0">lc2 = art3d.Line3DCollection(lines2</span><span class="s1">, </span><span class="s0">linestyles=</span><span class="s3">&quot;-.&quot;</span><span class="s0">)</span>
    <span class="s0">lc3 = art3d.Line3DCollection(lines3</span><span class="s1">, </span><span class="s0">linestyles=</span><span class="s3">&quot;:&quot;</span><span class="s1">, </span><span class="s0">lw=</span><span class="s4">.5</span><span class="s0">)</span>

    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">ax.add_collection(lc1)</span>
    <span class="s0">ax.add_collection(lc2)</span>
    <span class="s0">ax.add_collection(lc3)</span>

    <span class="s0">leg = ax.legend([lc1</span><span class="s1">, </span><span class="s0">lc2</span><span class="s1">, </span><span class="s0">lc3]</span><span class="s1">, </span><span class="s0">[</span><span class="s3">'line1'</span><span class="s1">, </span><span class="s3">'line2'</span><span class="s1">, </span><span class="s3">'line 3'</span><span class="s0">])</span>
    <span class="s0">h1</span><span class="s1">, </span><span class="s0">h2</span><span class="s1">, </span><span class="s0">h3 = leg.legend_handles</span>

    <span class="s1">for </span><span class="s0">oh</span><span class="s1">, </span><span class="s0">lh </span><span class="s1">in </span><span class="s0">zip((lc1</span><span class="s1">, </span><span class="s0">lc2</span><span class="s1">, </span><span class="s0">lc3)</span><span class="s1">, </span><span class="s0">(h1</span><span class="s1">, </span><span class="s0">h2</span><span class="s1">, </span><span class="s0">h3)):</span>
        <span class="s1">assert </span><span class="s0">oh.get_linestyles()[</span><span class="s4">0</span><span class="s0">] == lh._dash_pattern</span>


<span class="s1">def </span><span class="s0">test_handlerline3d():</span>
    <span class="s2"># Test marker consistency for monolithic Line3D legend handler.</span>
    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">ax.scatter([</span><span class="s4">0</span><span class="s1">, </span><span class="s4">1</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">0</span><span class="s1">, </span><span class="s4">1</span><span class="s0">]</span><span class="s1">, </span><span class="s0">marker=</span><span class="s3">&quot;v&quot;</span><span class="s0">)</span>
    <span class="s0">handles = [art3d.Line3D([</span><span class="s4">0</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">0</span><span class="s0">]</span><span class="s1">, </span><span class="s0">[</span><span class="s4">0</span><span class="s0">]</span><span class="s1">, </span><span class="s0">marker=</span><span class="s3">&quot;v&quot;</span><span class="s0">)]</span>
    <span class="s0">leg = ax.legend(handles</span><span class="s1">, </span><span class="s0">[</span><span class="s3">&quot;Aardvark&quot;</span><span class="s0">]</span><span class="s1">, </span><span class="s0">numpoints=</span><span class="s4">1</span><span class="s0">)</span>
    <span class="s1">assert </span><span class="s0">handles[</span><span class="s4">0</span><span class="s0">].get_marker() == leg.legend_handles[</span><span class="s4">0</span><span class="s0">].get_marker()</span>


<span class="s1">def </span><span class="s0">test_contour_legend_elements():</span>
    <span class="s1">from </span><span class="s0">matplotlib.collections </span><span class="s1">import </span><span class="s0">LineCollection</span>
    <span class="s0">x</span><span class="s1">, </span><span class="s0">y = np.mgrid[</span><span class="s4">1</span><span class="s0">:</span><span class="s4">10</span><span class="s1">, </span><span class="s4">1</span><span class="s0">:</span><span class="s4">10</span><span class="s0">]</span>
    <span class="s0">h = x * y</span>
    <span class="s0">colors = [</span><span class="s3">'blue'</span><span class="s1">, </span><span class="s3">'#00FF00'</span><span class="s1">, </span><span class="s3">'red'</span><span class="s0">]</span>

    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">cs = ax.contour(x</span><span class="s1">, </span><span class="s0">y</span><span class="s1">, </span><span class="s0">h</span><span class="s1">, </span><span class="s0">levels=[</span><span class="s4">10</span><span class="s1">, </span><span class="s4">30</span><span class="s1">, </span><span class="s4">50</span><span class="s0">]</span><span class="s1">, </span><span class="s0">colors=colors</span><span class="s1">, </span><span class="s0">extend=</span><span class="s3">'both'</span><span class="s0">)</span>

    <span class="s0">artists</span><span class="s1">, </span><span class="s0">labels = cs.legend_elements()</span>
    <span class="s1">assert </span><span class="s0">labels == [</span><span class="s3">'$x = 10.0$'</span><span class="s1">, </span><span class="s3">'$x = 30.0$'</span><span class="s1">, </span><span class="s3">'$x = 50.0$'</span><span class="s0">]</span>
    <span class="s1">assert </span><span class="s0">all(isinstance(a</span><span class="s1">, </span><span class="s0">LineCollection) </span><span class="s1">for </span><span class="s0">a </span><span class="s1">in </span><span class="s0">artists)</span>
    <span class="s1">assert </span><span class="s0">all(same_color(a.get_color()</span><span class="s1">, </span><span class="s0">c)</span>
               <span class="s1">for </span><span class="s0">a</span><span class="s1">, </span><span class="s0">c </span><span class="s1">in </span><span class="s0">zip(artists</span><span class="s1">, </span><span class="s0">colors))</span>


<span class="s1">def </span><span class="s0">test_contourf_legend_elements():</span>
    <span class="s1">from </span><span class="s0">matplotlib.patches </span><span class="s1">import </span><span class="s0">Rectangle</span>
    <span class="s0">x</span><span class="s1">, </span><span class="s0">y = np.mgrid[</span><span class="s4">1</span><span class="s0">:</span><span class="s4">10</span><span class="s1">, </span><span class="s4">1</span><span class="s0">:</span><span class="s4">10</span><span class="s0">]</span>
    <span class="s0">h = x * y</span>

    <span class="s0">fig</span><span class="s1">, </span><span class="s0">ax = plt.subplots(subplot_kw=dict(projection=</span><span class="s3">'3d'</span><span class="s0">))</span>
    <span class="s0">cs = ax.contourf(x</span><span class="s1">, </span><span class="s0">y</span><span class="s1">, </span><span class="s0">h</span><span class="s1">, </span><span class="s0">levels=[</span><span class="s4">10</span><span class="s1">, </span><span class="s4">30</span><span class="s1">, </span><span class="s4">50</span><span class="s0">]</span><span class="s1">,</span>
                     <span class="s0">colors=[</span><span class="s3">'#FFFF00'</span><span class="s1">, </span><span class="s3">'#FF00FF'</span><span class="s1">, </span><span class="s3">'#00FFFF'</span><span class="s0">]</span><span class="s1">,</span>
                     <span class="s0">extend=</span><span class="s3">'both'</span><span class="s0">)</span>
    <span class="s0">cs.cmap.set_over(</span><span class="s3">'red'</span><span class="s0">)</span>
    <span class="s0">cs.cmap.set_under(</span><span class="s3">'blue'</span><span class="s0">)</span>
    <span class="s0">cs.changed()</span>
    <span class="s0">artists</span><span class="s1">, </span><span class="s0">labels = cs.legend_elements()</span>
    <span class="s1">assert </span><span class="s0">labels == [</span><span class="s3">'$x </span><span class="s1">\\</span><span class="s3">leq -1e+250s$'</span><span class="s1">,</span>
                      <span class="s3">'$10.0 &lt; x </span><span class="s1">\\</span><span class="s3">leq 30.0$'</span><span class="s1">,</span>
                      <span class="s3">'$30.0 &lt; x </span><span class="s1">\\</span><span class="s3">leq 50.0$'</span><span class="s1">,</span>
                      <span class="s3">'$x &gt; 1e+250s$'</span><span class="s0">]</span>
    <span class="s0">expected_colors = (</span><span class="s3">'blue'</span><span class="s1">, </span><span class="s3">'#FFFF00'</span><span class="s1">, </span><span class="s3">'#FF00FF'</span><span class="s1">, </span><span class="s3">'red'</span><span class="s0">)</span>
    <span class="s1">assert </span><span class="s0">all(isinstance(a</span><span class="s1">, </span><span class="s0">Rectangle) </span><span class="s1">for </span><span class="s0">a </span><span class="s1">in </span><span class="s0">artists)</span>
    <span class="s1">assert </span><span class="s0">all(same_color(a.get_facecolor()</span><span class="s1">, </span><span class="s0">c)</span>
               <span class="s1">for </span><span class="s0">a</span><span class="s1">, </span><span class="s0">c </span><span class="s1">in </span><span class="s0">zip(artists</span><span class="s1">, </span><span class="s0">expected_colors))</span>
</pre>
</body>
</html>